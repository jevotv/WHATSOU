"use strict";(()=>{var e={};e.id=8494,e.ids=[8494],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},15359:(e,t,i)=>{i.r(t),i.d(t,{headerHooks:()=>_,originalPathname:()=>b,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>d,staticGenerationAsyncStorage:()=>l,staticGenerationBailout:()=>x});var s={};i.r(s),i.d(s,{GET:()=>GET}),i(44388);var a=i(15789),r=i(74902),n=i(70914),u=i(70106),o=i(19717);async function GET(e){return(0,u.Q)(e,async(e,t)=>{let i=(0,o.t)(),{data:s}=await i.from("subscriptions").select("*").eq("user_id",t.userId).single();if(!s)return n.Z.json({id:null,status:"inactive",expiresAt:null,daysRemaining:null,isReadOnly:!0,amount:100,isFirstSubscription:!0});let a=null,r="active",u=!1,p=new Date;if(s.expires_at){let e=new Date(s.expires_at),t=s.grace_ends_at?new Date(s.grace_ends_at):null;a=Math.ceil((e.getTime()-p.getTime())/864e5),p>e?(r=t&&p<=t?"grace":"expired",u=!0):(r="active",u=!1)}else if(s.pending_expires_at){let e=new Date(s.pending_expires_at);p<=e?(r="active",u=!1,a=null):(r="inactive",u=!0)}else r="inactive",u=!0;let c=s.is_first_subscription?100:300;return n.Z.json({id:s.id,status:r,expiresAt:s.expires_at,daysRemaining:a,isReadOnly:u,amount:c,isFirstSubscription:!!s.is_first_subscription})})}let p=new a.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/subscription/status/route",pathname:"/api/subscription/status",filename:"route",bundlePath:"app/api/subscription/status/route"},resolvedPagePath:"D:\\whatsou\\apps\\web\\app\\api\\subscription\\status\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:d,headerHooks:_,staticGenerationBailout:x}=p,b="/api/subscription/status/route"}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),i=t.X(0,[771,1861,2605,3926,914,497,5250,9717,106],()=>__webpack_exec__(15359));module.exports=i})();
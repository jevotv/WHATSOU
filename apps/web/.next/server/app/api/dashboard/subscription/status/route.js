"use strict";(()=>{var e={};e.id=2199,e.ids=[2199],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},66204:(e,t,s)=>{s.r(t),s.d(t,{headerHooks:()=>_,originalPathname:()=>x,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>l,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>b});var i={};s.r(i),s.d(i,{GET:()=>GET,OPTIONS:()=>OPTIONS}),s(44388);var a=s(15789),r=s(74902),n=s(70914),u=s(70106),o=s(19717);async function OPTIONS(){return new n.Z(null,{status:200})}async function GET(e){return(0,u.Q)(e,async(e,t)=>{let s=(0,o.t)(),{data:i}=await s.from("subscriptions").select("*").eq("user_id",t.userId).single();if(!i)return n.Z.json({id:null,status:"inactive",expiresAt:null,daysRemaining:null,isReadOnly:!0,amount:100,isFirstSubscription:!0});let a=null,r="active",u=!1,p=new Date;if(i.expires_at){let e=new Date(i.expires_at),t=i.grace_ends_at?new Date(i.grace_ends_at):null;a=Math.ceil((e.getTime()-p.getTime())/864e5),p>e?(r=t&&p<=t?"grace":"expired",u=!0):(r="active",u=!1)}else if(i.pending_expires_at){let e=new Date(i.pending_expires_at);p<=e?(r="active",u=!1,a=null):(r="inactive",u=!0)}else r="inactive",u=!0;let d=i.is_first_subscription?100:300;return n.Z.json({id:i.id,status:r,expiresAt:i.expires_at,daysRemaining:a,isReadOnly:u,amount:d,isFirstSubscription:!!i.is_first_subscription})})}let p=new a.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/dashboard/subscription/status/route",pathname:"/api/dashboard/subscription/status",filename:"route",bundlePath:"app/api/dashboard/subscription/status/route"},resolvedPagePath:"D:\\whatsou\\apps\\web\\app\\api\\dashboard\\subscription\\status\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:l,headerHooks:_,staticGenerationBailout:b}=p,x="/api/dashboard/subscription/status/route"}};var t=require("../../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[771,1861,2605,3926,914,497,5250,9717,106],()=>__webpack_exec__(66204));module.exports=s})();
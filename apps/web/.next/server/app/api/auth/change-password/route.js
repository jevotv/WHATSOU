"use strict";(()=>{var e={};e.id=8814,e.ids=[8814],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},69159:(e,r,a)=>{a.r(r),a.d(r,{headerHooks:()=>l,originalPathname:()=>_,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>w,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>g});var s={};a.r(s),a.d(s,{POST:()=>POST}),a(44388);var t=a(15789),o=a(74902),u=a(70914),n=a(62094),i=a(70106),p=a(19717);async function POST(e){return(0,i.Q)(e,async(e,r)=>{let a=await e.json(),{currentPassword:s,newPassword:t}=a;if(!s||!t)return u.Z.json({error:"Current and new password are required"},{status:400});if(t.length<6)return u.Z.json({error:"Password must be at least 6 characters"},{status:400});let o=(0,p.t)(),{data:i,error:d}=await o.from("users").select("password_hash").eq("id",r.userId).single();if(d||!i)return u.Z.json({error:"User not found"},{status:404});let c=await n.ZP.compare(s,i.password_hash);if(!c)return u.Z.json({error:"Incorrect current password"},{status:401});let h=await n.ZP.hash(t,10),{error:w}=await o.from("users").update({password_hash:h}).eq("id",r.userId);return w?u.Z.json({error:w.message},{status:500}):u.Z.json({success:!0})})}let d=new t.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/change-password/route",pathname:"/api/auth/change-password",filename:"route",bundlePath:"app/api/auth/change-password/route"},resolvedPagePath:"D:\\whatsou\\apps\\web\\app\\api\\auth\\change-password\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:h,serverHooks:w,headerHooks:l,staticGenerationBailout:g}=d,_="/api/auth/change-password/route"}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),a=r.X(0,[771,1861,2605,3926,914,497,5250,2094,9717,106],()=>__webpack_exec__(69159));module.exports=a})();
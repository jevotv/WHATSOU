"use strict";(()=>{var e={};e.id=7603,e.ids=[7603],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},28509:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>T,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>l,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>g});var s={};r.r(s),r.d(s,{GET:()=>GET,OPTIONS:()=>OPTIONS}),r(44388);var n=r(15789),a=r(74902),o=r(70914),u=r(42719),i=r(19717);async function OPTIONS(){return o.Z.json({},{status:200})}async function GET(e){try{let t=e.headers.get("Authorization");if(!t?.startsWith("Bearer "))return o.Z.json({authenticated:!1,user:null},{status:200});let r=t.substring(7),s=await (0,u.W)(r);if(!s)return o.Z.json({authenticated:!1,user:null},{status:200});let n=(0,i.t)(),{data:a}=await n.from("users").select("id, phone, created_at").eq("id",s.userId).single();return o.Z.json({authenticated:!0,user:a||{id:s.userId,phone:s.phone}})}catch(e){return console.error("Session check error:",e),o.Z.json({authenticated:!1,user:null,error:e.message},{status:200})}}let c=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/session/route",pathname:"/api/auth/session",filename:"route",bundlePath:"app/api/auth/session/route"},resolvedPagePath:"D:\\whatsou\\apps\\web\\app\\api\\auth\\session\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:l,headerHooks:h,staticGenerationBailout:g}=c,T="/api/auth/session/route"},42719:(e,t,r)=>{r.d(t,{W:()=>verifyToken,f:()=>signToken});var s=r(37200),n=r(24133);let a=new TextEncoder().encode(process.env.JWT_SECRET||"fallback-secret-change-in-production");async function signToken(e,t){let r=await new s.N({userId:e,phone:t}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(a);return r}async function verifyToken(e){try{let{payload:t}=await (0,n._)(e,a);return{userId:t.userId,phone:t.phone}}catch{return null}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[771,1861,2605,3926,914,497,5250,9717],()=>__webpack_exec__(28509));module.exports=r})();
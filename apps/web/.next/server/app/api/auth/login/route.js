"use strict";(()=>{var e={};e.id=8873,e.ids=[8873],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},95201:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>m,originalPathname:()=>_,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>S});var o={};t.r(o),t.d(o,{OPTIONS:()=>OPTIONS,POST:()=>POST}),t(44388);var a=t(15789),s=t(74902),n=t(70914),i=t(62094),u=t(19717),p=t(42719),l=t(34823);async function OPTIONS(){return n.Z.json({},{status:200})}async function POST(e){try{let r=await e.json(),{phone:t,password:o}=r;if(!t||!o)return n.Z.json({error:"Phone and password are required"},{status:400});let a=(0,l.yL)(t),s=(0,u.t)(),{data:c,error:d}=await s.from("users").select("*").eq("phone",a).single();if(d||!c)return n.Z.json({error:"Invalid phone number or password"},{status:401});let h=await i.ZP.compare(o,c.password_hash);if(!h)return n.Z.json({error:"Invalid phone number or password"},{status:401});let g=await (0,p.f)(c.id,c.phone);console.log("Login successful for:",c.phone);let m=!process.env.JWT_SECRET;console.log("JWT Secret Status:",m?"USING FALLBACK":"CUSTOM SECRET CONFIGURED");let S=n.Z.json({success:!0,token:g,user:{id:c.id,phone:c.phone,created_at:c.created_at}});return S.cookies.set("app-session",g,{httpOnly:!1,secure:!1,sameSite:"lax",maxAge:604800,path:"/"}),S}catch(e){return console.error("Login error:",e),n.Z.json({error:e.message||"Login failed"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"D:\\whatsou\\apps\\web\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:g,headerHooks:m,staticGenerationBailout:S}=c,_="/api/auth/login/route"}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[771,1861,2605,3926,914,497,5250,2094,9717,5276],()=>__webpack_exec__(95201));module.exports=t})();
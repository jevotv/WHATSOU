"use strict";(()=>{var e={};e.id=3654,e.ids=[3654],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},18630:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>w,originalPathname:()=>A,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>m});var a={};r.r(a),r.d(a,{OPTIONS:()=>OPTIONS,POST:()=>POST}),r(44388);var o=r(15789),s=r(74902),n=r(70914),i=r(62094),u=r(19717),c=r(42719),p=r(34823);async function sendNewUserAlert(e,t){let r=`
ðŸ”” *New User Registered*

ðŸ‘¤ Name: N/A
ðŸ“± Phone: ${e}
ðŸ“… Date: ${new Date(t).toLocaleString("en-US")}
    `.trim();try{let e=await fetch("https://api.telegram.org/bot8289064862:AAGtVYRSK5Osuv3oIldMYkD0gAZxk5RyVDI/sendMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:"1177042323",text:r,parse_mode:"Markdown"})});e.ok||console.error("Failed to send Telegram notification:",await e.text())}catch(e){console.error("Error sending Telegram notification:",e)}}async function OPTIONS(){return new n.Z(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization, X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Date, X-Api-Version"}})}async function POST(e){try{let t=await e.json(),{phone:r,password:a,agreedToPrivacy:o}=t;if(!r||!a)return n.Z.json({error:"Phone and password are required"},{status:400});if(a.length<6)return n.Z.json({error:"Password must be at least 6 characters"},{status:400});let s=(0,p.yL)(r),d=(0,u.t)(),{data:l}=await d.from("users").select("id").eq("phone",s).single();if(l)return n.Z.json({error:"Phone number already registered"},{status:409});let h=await i.ZP.hash(a,10),{data:g,error:w}=await d.from("users").insert({phone:s,password_hash:h,agreed_to_privacy:o??!0}).select().single();if(w)return console.error("Signup error:",w),n.Z.json({error:`Failed to create account: ${w.message}`},{status:500});sendNewUserAlert(s,g.created_at).catch(console.error);let m=await (0,c.f)(g.id,g.phone),A=n.Z.json({success:!0,token:m,user:{id:g.id,phone:g.phone,created_at:g.created_at}});return A.cookies.set("app-session",m,{httpOnly:!1,secure:!1,sameSite:"lax",maxAge:604800,path:"/"}),A}catch(e){return console.error("Signup error:",e),n.Z.json({error:e.message||"Signup failed"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"D:\\whatsou\\apps\\web\\app\\api\\auth\\signup\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:g,headerHooks:w,staticGenerationBailout:m}=d,A="/api/auth/signup/route"}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[771,1861,2605,3926,914,497,5250,2094,9717,5276],()=>__webpack_exec__(18630));module.exports=r})();
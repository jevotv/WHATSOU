(()=>{var e={};e.id=7857,e.ids=[7857],e.modules={21841:e=>{"use strict";e.exports=require("@aws-sdk/client-s3")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},41790:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page-experimental.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},57147:e=>{"use strict";e.exports=require("fs")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},33701:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o});var t=r(66965),a=r(74902),l=r(36408),i=r.n(l),d=r(14346),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);r.d(s,n);let o=["",{children:["dashboard",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,71081)),"D:\\whatsou\\apps\\web\\app\\dashboard\\orders\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,97913)),"D:\\whatsou\\apps\\web\\app\\dashboard\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,47273)),"D:\\whatsou\\apps\\web\\app\\dashboard\\not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,47814))).default(e)],apple:[async e=>(await Promise.resolve().then(r.bind(r,90133))).default(e)],openGraph:[async e=>(await Promise.resolve().then(r.bind(r,3774))).default(e)],twitter:[],manifest:"/manifest.webmanifest"}}]},{layout:[()=>Promise.resolve().then(r.bind(r,27734)),"D:\\whatsou\\apps\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35438,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,47814))).default(e)],apple:[async e=>(await Promise.resolve().then(r.bind(r,90133))).default(e)],openGraph:[async e=>(await Promise.resolve().then(r.bind(r,3774))).default(e)],twitter:[],manifest:"/manifest.webmanifest"}}],c=["D:\\whatsou\\apps\\web\\app\\dashboard\\orders\\page.tsx"],x="/dashboard/orders/page",p={require:r,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/orders/page",pathname:"/dashboard/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},55208:(e,s,r)=>{Promise.resolve().then(r.bind(r,21087))},21087:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>OrdersPage});var t=r(84196),a=r(78726),l=r(65714),i=r(78611),d=r(34105),n=r(24850),o=r(56617),c=r(86442),x=r(85905),p=r(51356),u=r(5460),m=r(7930),h=r(50198),b=r(12753),y=r(8410),f=r(65884),g=r(13343),j=r(78019),_=r(3486),w=r(80019),v=r(11986),N=r(88737),Z=r(97487),P=r(57700),q=r(24288),k=r.n(q),D=r(69211);function OrdersPage(){let[e,s]=(0,a.useState)([]),[r,q]=(0,a.useState)(!0),[C,S]=(0,a.useState)(null),[E,A]=(0,a.useState)(""),[M,O]=(0,a.useState)("all"),[Q,F]=(0,a.useState)("all"),[G,R]=(0,a.useState)(!1),{t:$,direction:I,language:L}=(0,Z.Z)(),{subscription:B,loading:V}=(0,P.m)(),z=B?.isReadOnly??!1,{user:T}=(0,l.useAuth)(),U=(0,a.useCallback)(async()=>{if(T)try{let e=await D.h.get("/api/dashboard/orders");if(e.error){console.error("Error fetching orders:",e.error),q(!1);return}e.storeSettings&&R(!0===e.storeSettings.allow_delivery&&!0===e.storeSettings.allow_pickup),s(e.orders||[])}catch(e){console.error("Unexpected error:",e)}finally{q(!1)}},[T]);(0,a.useEffect)(()=>{U()},[U]);let toggleExpand=e=>{S(C===e?null:e)};return r||V?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[50vh]",children:(0,t.jsx)(i.Z,{className:"w-8 h-8 animate-spin text-gray-400"})}):z?(0,t.jsx)("div",{className:"max-w-md mx-auto px-4 py-16 text-center",children:(0,t.jsxs)("div",{className:"bg-red-100 border-2 border-red-500 rounded-2xl p-8",children:[(0,t.jsx)(d.Z,{className:"w-16 h-16 mx-auto text-red-600 mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"ar"===L?"وضع القراءة فقط":"Read-Only Mode"}),(0,t.jsx)("p",{className:"text-red-600 mb-6",children:"ar"===L?"اشتراكك منتهي. جدد للوصول لبيانات الطلبات.":"Your subscription has expired. Renew to access order data."}),(0,t.jsx)(k(),{href:"/dashboard/subscription",className:"inline-block bg-red-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-red-700",children:"ar"===L?"جدد الآن":"Renew Now"})]})}):(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8 pb-32",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:$("dashboard.nav_orders")||"Orders"}),(0,t.jsx)("span",{className:"bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-sm font-medium",children:e.length})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(n.Z,{className:`absolute ${"rtl"===I?"right-3":"left-3"} top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4`}),(0,t.jsx)(b.I,{placeholder:$("dashboard.search_orders"),value:E,onChange:e=>A(e.target.value),className:`${"rtl"===I?"pr-10":"pl-10"} rounded-xl bg-white`})]}),(0,t.jsxs)(y.Ph,{value:M,onValueChange:O,children:[(0,t.jsxs)(y.i4,{className:"w-full sm:w-[180px] rounded-xl bg-white",children:[(0,t.jsx)(o.Z,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,t.jsx)(y.ki,{placeholder:"Filter by date"})]}),(0,t.jsxs)(y.Bw,{children:[(0,t.jsx)(y.Ql,{value:"all",children:$("dashboard.filter_all")}),(0,t.jsx)(y.Ql,{value:"today",children:$("dashboard.filter_today")}),(0,t.jsx)(y.Ql,{value:"yesterday",children:$("dashboard.filter_yesterday")}),(0,t.jsx)(y.Ql,{value:"last_7_days",children:$("dashboard.filter_last_7_days")}),(0,t.jsx)(y.Ql,{value:"last_30_days",children:$("dashboard.filter_last_30_days")})]})]}),G&&(0,t.jsxs)(y.Ph,{value:Q,onValueChange:F,children:[(0,t.jsx)(y.i4,{className:"w-full sm:w-[150px] rounded-xl bg-white",children:(0,t.jsx)(y.ki,{placeholder:$("dashboard.filter_delivery_type")})}),(0,t.jsxs)(y.Bw,{children:[(0,t.jsx)(y.Ql,{value:"all",children:$("dashboard.filter_all_types")}),(0,t.jsx)(y.Ql,{value:"delivery",children:$("dashboard.filter_delivery")}),(0,t.jsx)(y.Ql,{value:"pickup",children:$("dashboard.filter_pickup")})]})]})]}),0===e.filter(e=>{let s=E.toLowerCase(),r=e.customer_name.toLowerCase().includes(s)||e.customer_phone.includes(s);if(!r)return!1;let t=(0,N.Z)(e.created_at);return"today"===M?(0,g.Z)(t):"yesterday"===M?(0,j.Z)(t):"last_7_days"===M?(0,w.Z)(t,(0,_.Z)((0,v.Z)(new Date),7)):"last_30_days"!==M||(0,w.Z)(t,(0,_.Z)((0,v.Z)(new Date),30))}).filter(e=>"all"===Q||e.delivery_type===Q).length?(0,t.jsxs)("div",{className:"text-center py-12 bg-white rounded-2xl border border-dashed border-gray-200",children:[(0,t.jsx)(c.Z,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),(0,t.jsx)("p",{className:"text-gray-500",children:$("dashboard.no_orders")||"No orders found"})]}):(0,t.jsx)("div",{className:"space-y-4",children:e.filter(e=>{let s=E.toLowerCase(),r=e.customer_name.toLowerCase().includes(s)||e.customer_phone.includes(s);if(!r)return!1;let t=(0,N.Z)(e.created_at);return"today"===M?(0,g.Z)(t):"yesterday"===M?(0,j.Z)(t):"last_7_days"===M?(0,w.Z)(t,(0,_.Z)((0,v.Z)(new Date),7)):"last_30_days"!==M||(0,w.Z)(t,(0,_.Z)((0,v.Z)(new Date),30))}).filter(e=>"all"===Q||e.delivery_type===Q).map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 flex flex-col sm:flex-row sm:items-center justify-between gap-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>toggleExpand(e.id),children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["pickup"===e.delivery_type?(0,t.jsx)("span",{title:$("dashboard.filter_pickup"),className:"text-lg",children:"\uD83C\uDFEA"}):(0,t.jsx)("span",{title:$("dashboard.filter_delivery"),className:"text-lg",children:"\uD83C\uDFE0"}),(0,t.jsx)("span",{className:"font-bold text-lg",children:e.customer_name})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(x.Z,{className:"w-3 h-3"})," ",e.customer_phone]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(p.Z,{className:"w-3 h-3"})," ",(0,f.ZP)(new Date(e.created_at),"MMM d, yyyy h:mm a")]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between sm:justify-end gap-4 min-w-[120px]",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-bold text-lg",children:[$("common.currency")," ",Number(e.total_price).toFixed(2)]}),void 0!==e.shipping_cost&&e.shipping_cost>0&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["(Inc. ",$("common.currency")," ",Number(e.shipping_cost).toFixed(2)," Shipping)"]})]}),C===e.id?(0,t.jsx)(u.Z,{className:"w-5 h-5 text-gray-400"}):(0,t.jsx)(m.Z,{className:"w-5 h-5 text-gray-400"})]})]}),C===e.id&&(0,t.jsxs)("div",{className:"p-4 bg-gray-50 border-t border-gray-100 space-y-4",children:[(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("h4",{className:"font-medium mb-2 text-gray-700 flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4"})," ",$("customers.delivery_address")]}),(0,t.jsxs)("div",{className:"text-gray-600 pl-6 space-y-1",children:[(0,t.jsx)("p",{children:e.customer_address}),(e.city||e.district)&&(0,t.jsx)("p",{className:"text-sm text-gray-400",children:[e.district,e.city].filter(Boolean).join(", ")})]})]}),e.notes&&(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("h4",{className:"font-medium mb-2 text-gray-700 flex items-center gap-2",children:["\uD83D\uDCDD ",$("common.notes")||"Notes"]}),(0,t.jsx)("p",{className:"text-gray-600 pl-6",children:e.notes})]}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("h4",{className:"font-medium mb-2 text-gray-700 flex items-center gap-2",children:[(0,t.jsx)(c.Z,{className:"w-4 h-4"})," ",$("customers.order_items")]}),(0,t.jsx)("div",{className:"pl-6 space-y-2",children:Array.isArray(e.order_items)&&e.order_items.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center text-gray-600 bg-white p-2 rounded-lg border border-gray-100",children:[(0,t.jsxs)("span",{children:[(0,t.jsxs)("span",{className:"font-semibold text-black",children:[e.quantity,"x"]})," ",e.product_name,e.selected_options&&Object.keys(e.selected_options).length>0&&(0,t.jsxs)("span",{className:"text-gray-400 ml-1 text-xs",children:["(",Object.entries(e.selected_options).map(([e,s])=>`${e}:${s}`).join(", "),")"]})]}),(0,t.jsxs)("span",{children:[$("common.currency")," ",(e.price*e.quantity).toFixed(2)]})]},s))})]})]})]},e.id))})]})}},12753:(e,s,r)=>{"use strict";r.d(s,{I:()=>i});var t=r(84196),a=r(78726),l=r(42135);let i=a.forwardRef(({className:e,type:s,...r},a)=>(0,t.jsx)("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r}));i.displayName="Input"},71081:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>i,__esModule:()=>l,default:()=>n});var t=r(64074);let a=(0,t.createProxy)(String.raw`D:\whatsou\apps\web\app\dashboard\orders\page.tsx`),{__esModule:l,$$typeof:i}=a,d=a.default,n=d}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[771,7124,4304,6819,9328,4288,1980,265,3665,5131,129,3345,1890,533,3517,8444,4378,7952,7286,8410,2855],()=>__webpack_exec__(33701));module.exports=r})();
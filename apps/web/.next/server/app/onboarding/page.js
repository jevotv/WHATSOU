(()=>{var e={};e.id=8461,e.ids=[8461],e.modules={21841:e=>{"use strict";e.exports=require("@aws-sdk/client-s3")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},41790:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page-experimental.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},57147:e=>{"use strict";e.exports=require("fs")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},19870:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>o.a,__next_app__:()=>g,originalPathname:()=>u,pages:()=>c,routeModule:()=>b,tree:()=>l});var t=r(66965),n=r(74902),s=r(36408),o=r.n(s),i=r(14346),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(a,d);let l=["",{children:["onboarding",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,56859)),"D:\\whatsou\\apps\\web\\app\\onboarding\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,47814))).default(e)],apple:[async e=>(await Promise.resolve().then(r.bind(r,90133))).default(e)],openGraph:[async e=>(await Promise.resolve().then(r.bind(r,3774))).default(e)],twitter:[],manifest:"/manifest.webmanifest"}}]},{layout:[()=>Promise.resolve().then(r.bind(r,27734)),"D:\\whatsou\\apps\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35438,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,47814))).default(e)],apple:[async e=>(await Promise.resolve().then(r.bind(r,90133))).default(e)],openGraph:[async e=>(await Promise.resolve().then(r.bind(r,3774))).default(e)],twitter:[],manifest:"/manifest.webmanifest"}}],c=["D:\\whatsou\\apps\\web\\app\\onboarding\\page.tsx"],u="/onboarding/page",g={require:r,loadChunk:()=>Promise.resolve()},b=new t.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/onboarding/page",pathname:"/onboarding",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},76685:(e,a,r)=>{let t={"794157ea47e2106a7052b432086ad1b87e095461":()=>Promise.resolve().then(r.bind(r,82610)).then(e=>e.signUp),f2a595d6207f10ec2702e3a63c3639433bdad896:()=>Promise.resolve().then(r.bind(r,82610)).then(e=>e.getSession),dac5dc3f6ed84f3fefb6b3b31363644a8fb7a355:()=>Promise.resolve().then(r.bind(r,82610)).then(e=>e.changePassword),d625827fa7c2c77be09b75528bdad178aa3c081c:()=>Promise.resolve().then(r.bind(r,82610)).then(e=>e.signOut),b5d5296f57824f20697bf651a3e62d3a07a7262e:()=>Promise.resolve().then(r.bind(r,82610)).then(e=>e.deleteAccount),f5490e7217b4beda3444cfb66f3894e5692d3768:()=>Promise.resolve().then(r.bind(r,82610)).then(e=>e.saveFcmToken),ba699b676f4f91d1d7d1921ad4b89a747ef10c53:()=>Promise.resolve().then(r.bind(r,82610)).then(e=>e.signIn),"4a527ee583574be2bdf9f2177929a02116078f62":()=>Promise.resolve().then(r.bind(r,94065)).then(e=>e.createProduct),"27012f75ad6661d643d69cd56779e93b523e4e74":()=>Promise.resolve().then(r.bind(r,94065)).then(e=>e.deleteProduct),"062daab9f475cd399623ce936833fde70b64c375":()=>Promise.resolve().then(r.bind(r,94065)).then(e=>e.updateProduct),ab59a523b5f966d77a2cdbf664645220244c0c9e:()=>Promise.resolve().then(r.bind(r,94065)).then(e=>e.getProductsForStore),eae23fc9d6e8db8b55a13f1501c8c092743db0a8:()=>Promise.resolve().then(r.bind(r,94065)).then(e=>e.getCustomers),b9b850b25d6da988503c0d70f38405029a471f66:()=>Promise.resolve().then(r.bind(r,94065)).then(e=>e.getOrders),"9cc01ad5d382d64e5098ab2fcec9ddce5a16badb":()=>Promise.resolve().then(r.bind(r,94065)).then(e=>e.updateStore),a2ed93aa8ca9dc0bc546057e9e58b564fc8002c3:()=>Promise.resolve().then(r.bind(r,94065)).then(e=>e.getOrdersCount),f7b5cdc95bc89222d92deaf1da2084c26b2dcda0:()=>Promise.resolve().then(r.bind(r,60936)).then(e=>e.regenerateStoreQR),"25b98238d93637f90585aed364c92879b0673db2":()=>Promise.resolve().then(r.bind(r,60936)).then(e=>e.getStoreForCurrentUser),"352429c5adab088f0a38a8877021dd6fceb97eb0":()=>Promise.resolve().then(r.bind(r,60936)).then(e=>e.createStore)};async function endpoint(e,...a){let r=await t[e]();return r.apply(null,a)}e.exports={"794157ea47e2106a7052b432086ad1b87e095461":endpoint.bind(null,"794157ea47e2106a7052b432086ad1b87e095461"),f2a595d6207f10ec2702e3a63c3639433bdad896:endpoint.bind(null,"f2a595d6207f10ec2702e3a63c3639433bdad896"),dac5dc3f6ed84f3fefb6b3b31363644a8fb7a355:endpoint.bind(null,"dac5dc3f6ed84f3fefb6b3b31363644a8fb7a355"),d625827fa7c2c77be09b75528bdad178aa3c081c:endpoint.bind(null,"d625827fa7c2c77be09b75528bdad178aa3c081c"),b5d5296f57824f20697bf651a3e62d3a07a7262e:endpoint.bind(null,"b5d5296f57824f20697bf651a3e62d3a07a7262e"),f5490e7217b4beda3444cfb66f3894e5692d3768:endpoint.bind(null,"f5490e7217b4beda3444cfb66f3894e5692d3768"),ba699b676f4f91d1d7d1921ad4b89a747ef10c53:endpoint.bind(null,"ba699b676f4f91d1d7d1921ad4b89a747ef10c53"),"4a527ee583574be2bdf9f2177929a02116078f62":endpoint.bind(null,"4a527ee583574be2bdf9f2177929a02116078f62"),"27012f75ad6661d643d69cd56779e93b523e4e74":endpoint.bind(null,"27012f75ad6661d643d69cd56779e93b523e4e74"),"062daab9f475cd399623ce936833fde70b64c375":endpoint.bind(null,"062daab9f475cd399623ce936833fde70b64c375"),ab59a523b5f966d77a2cdbf664645220244c0c9e:endpoint.bind(null,"ab59a523b5f966d77a2cdbf664645220244c0c9e"),eae23fc9d6e8db8b55a13f1501c8c092743db0a8:endpoint.bind(null,"eae23fc9d6e8db8b55a13f1501c8c092743db0a8"),b9b850b25d6da988503c0d70f38405029a471f66:endpoint.bind(null,"b9b850b25d6da988503c0d70f38405029a471f66"),"9cc01ad5d382d64e5098ab2fcec9ddce5a16badb":endpoint.bind(null,"9cc01ad5d382d64e5098ab2fcec9ddce5a16badb"),a2ed93aa8ca9dc0bc546057e9e58b564fc8002c3:endpoint.bind(null,"a2ed93aa8ca9dc0bc546057e9e58b564fc8002c3"),f7b5cdc95bc89222d92deaf1da2084c26b2dcda0:endpoint.bind(null,"f7b5cdc95bc89222d92deaf1da2084c26b2dcda0"),"25b98238d93637f90585aed364c92879b0673db2":endpoint.bind(null,"25b98238d93637f90585aed364c92879b0673db2"),"352429c5adab088f0a38a8877021dd6fceb97eb0":endpoint.bind(null,"352429c5adab088f0a38a8877021dd6fceb97eb0")}},61280:(e,a,r)=>{Promise.resolve().then(r.bind(r,33596))},33596:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>OnboardingPage});var t=r(84196),n=r(78726),s=r(65714),o=r(74555),i=r(12428);r(11538),r(94574);var d=r(53696),l=(0,d.$)("352429c5adab088f0a38a8877021dd6fceb97eb0");(0,d.$)("f7b5cdc95bc89222d92deaf1da2084c26b2dcda0"),(0,d.$)("25b98238d93637f90585aed364c92879b0673db2");var c=r(2420),u=r(12753),g=r(91586),b=r(62364),p=r(32583),m=r(38249),h=r(58406),f=r(8336),x=r(53374),v=r(6006),_=r(85905),w=r(29930),j=r(64690),y=r(25413),N=r(19886),S=r(19328),P=r.n(S),k=r(82182),C=r(97487),q=r(15246),$=r(59640),L=r(52065);function OnboardingPage(){let[e,a]=(0,n.useState)(1),[r,d]=(0,n.useState)(!1),[S,U]=(0,n.useState)(!0),{user:E,loading:I}=(0,s.useAuth)(),A=(0,o.useRouter)(),{toast:z}=(0,y.pm)(),{t:R,language:Z,setLanguage:D,direction:O}=(0,C.Z)(),[F,G]=(0,n.useState)(""),[T,M]=(0,n.useState)(""),[Q,B]=(0,n.useState)(!1),[X,H]=(0,n.useState)(""),[V,W]=(0,n.useState)(!0),[Y,J]=(0,n.useState)(!1),[K,ee]=(0,n.useState)("en"),[ea,er]=(0,n.useState)(null),[et,en]=(0,n.useState)(""),[es,eo]=(0,n.useState)(""),[ei,ed]=(0,n.useState)(""),[el,ec]=(0,n.useState)(""),[eu,eg]=(0,n.useState)(""),[eb,ep]=(0,n.useState)(""),[em,eh]=(0,n.useState)("");(0,n.useEffect)(()=>{let checkExistingStore=async()=>{if(I)return;if(!E){A.push("/login");return}let{data:e}=await i.O.from("stores").select("id").eq("user_id",E.id).maybeSingle();e?A.push("/dashboard"):U(!1)};checkExistingStore()},[E,A,I]);let handleDefaultLanguageChange=e=>{ee(e),("ar"===e||"en"===e)&&D(e)},generateSlug=e=>(0,q.l)(e),handleGetLocation=async()=>{if(L.Capacitor.isNativePlatform()){try{z({title:R("onboarding.locating"),description:R("onboarding.getting_location")});let e=await $.b.checkPermissions();if("granted"!==e.location){let e=await $.b.requestPermissions();if("granted"!==e.location)throw Error("Permission denied")}let a=await $.b.getCurrentPosition(),{latitude:r,longitude:t}=a.coords,n=`https://www.google.com/maps?q=${r},${t}`;eh(n),z({title:R("onboarding.location_found"),description:R("onboarding.location_set")})}catch(e){console.error("Geolocation error:",e),z({title:R("common.error"),description:e.message||R("onboarding.location_error"),variant:"destructive"})}return}if(!navigator.geolocation){z({title:R("common.error"),description:R("onboarding.geolocation_not_supported"),variant:"destructive"});return}z({title:R("onboarding.locating"),description:R("onboarding.getting_location")}),navigator.geolocation.getCurrentPosition(e=>{let{latitude:a,longitude:r}=e.coords,t=`https://www.google.com/maps?q=${a},${r}`;eh(t),z({title:R("onboarding.location_found"),description:R("onboarding.location_set")})},e=>{console.error("Geolocation error:",e);let a=R("onboarding.location_error");e.code===e.PERMISSION_DENIED?a=R("onboarding.location_permission_denied"):e.code===e.POSITION_UNAVAILABLE?a=R("onboarding.location_unavailable"):e.code===e.TIMEOUT&&(a=R("onboarding.location_timeout")),z({title:R("common.error"),description:a,variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},uploadLogo=async()=>{if(!ea)return null;try{let e=new FormData;e.append("file",ea),e.append("folder","logos");let a=await fetch("/api/upload",{method:"POST",body:e}),r=await a.json();if(!a.ok)throw Error(r.error||"Upload failed");return r.url}catch(e){return console.error("Logo upload error:",e),z({title:R("onboarding.logo_upload_warning"),description:R("onboarding.logo_upload_failed"),variant:"destructive"}),null}},handleSubmit=async()=>{if(E){d(!0);try{let e=T||generateSlug(F),{data:r}=await i.O.from("stores").select("id").eq("slug",e).maybeSingle();if(r){z({title:R("onboarding.store_name_taken"),description:R("onboarding.store_name_taken_desc"),variant:"destructive"}),d(!1),a(1);return}let t=await uploadLogo(),n=new FormData;n.append("name",F),n.append("slug",e),X&&n.append("description",X),n.append("whatsapp_number",(0,N.yL)(E.phone)),n.append("default_language",K),es&&n.append("email",es),t&&n.append("logo_url",t),ei&&n.append("facebook_url",ei),el&&n.append("instagram_url",el),eu&&n.append("twitter_url",eu),eb&&n.append("tiktok_url",eb),em&&n.append("location_url",em),n.append("allow_delivery",String(V)),n.append("allow_pickup",String(Y));let s=await l(null,n);if(s.error)throw Error(s.error);z({title:R("onboarding.store_created"),description:R("onboarding.welcome_message")}),A.push("/dashboard/subscription")}catch(e){z({title:R("common.error"),description:e.message,variant:"destructive"}),d(!1)}}};return S?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):(0,t.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 to-teal-50 p-4",dir:O,children:[(0,t.jsx)(c.z,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 bg-white/50 backdrop-blur-sm rounded-full hover:bg-white/80 transition-all z-10",onClick:()=>{D("en"===Z?"ar":"en")},title:"Switch Language",children:(0,t.jsx)(p.Z,{className:"w-5 h-5 text-green-700"})}),(0,t.jsxs)(b.Zb,{className:"w-full max-w-2xl rounded-3xl shadow-xl overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-green-600 p-2",children:(0,t.jsxs)("div",{className:`flex justify-center gap-2 ${"rtl"===O?"flex-row-reverse":""}`,children:[(0,t.jsx)("div",{className:`h-2 w-1/2 rounded-full transition-all ${e>=1?"bg-white":"bg-green-800/30"}`}),(0,t.jsx)("div",{className:`h-2 w-1/2 rounded-full transition-all ${e>=2?"bg-white":"bg-green-800/30"}`})]})}),(0,t.jsxs)(b.Ol,{className:"text-center space-y-4 pt-8",children:[(0,t.jsx)("div",{className:"mx-auto bg-green-100 w-16 h-16 rounded-3xl flex items-center justify-center mb-2",children:1===e?(0,t.jsx)(P(),{src:"/logo.png",alt:"WhatSou Logo",width:48,height:48,className:"w-10 h-10 object-contain"}):(0,t.jsx)(m.Z,{className:"w-8 h-8 text-green-600"})}),(0,t.jsx)(b.ll,{className:"text-3xl font-bold",children:1===e?R("onboarding.step1_title"):R("onboarding.step2_title")}),(0,t.jsx)(b.SZ,{className:"text-base",children:1===e?R("onboarding.step1_desc"):R("onboarding.step2_desc")})]}),(0,t.jsx)(b.aY,{className:"p-8",children:1===e?(0,t.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-right-8 fade-in-0 duration-300",children:[(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(k._,{children:[R("onboarding.store_name")," ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(u.I,{placeholder:R("onboarding.store_name"),value:F,onChange:e=>G(e.target.value),className:"rounded-xl h-12"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",dir:"ltr",children:R("onboarding.store_url").replace("{slug}","")}),Q?(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-1 max-w-[200px]",children:[(0,t.jsx)(u.I,{value:T,onChange:e=>M((0,q.l)(e.target.value)),className:"h-7 text-xs px-2 rounded-md",autoFocus:!0,placeholder:"my-store"}),(0,t.jsx)("button",{onClick:()=>B(!1),className:"p-1 hover:bg-gray-100 rounded-full text-green-600",children:(0,t.jsx)(h.Z,{className:"w-4 h-4"})})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2 group",children:[(0,t.jsx)("span",{className:"font-medium text-xs text-green-700 bg-green-50 px-2 py-0.5 rounded dir-ltr",children:T||generateSlug(F)||"store-name"}),(0,t.jsx)("button",{onClick:()=>{T||M(generateSlug(F)),B(!0)},className:"p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-gray-100 rounded-full text-gray-500",title:"Edit URL",children:(0,t.jsx)(f.Z,{className:"w-3 h-3"})})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k._,{children:R("onboarding.default_language")}),(0,t.jsxs)("div",{className:"flex gap-4 p-3 border rounded-xl bg-gray-50/50",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"radio",name:"language",value:"en",checked:"en"===K,onChange:e=>handleDefaultLanguageChange(e.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-600"}),(0,t.jsx)("span",{children:R("onboarding.english")})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"radio",name:"language",value:"ar",checked:"ar"===K,onChange:e=>handleDefaultLanguageChange(e.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-600"}),(0,t.jsx)("span",{children:R("onboarding.arabic")})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(k._,{children:[R("onboarding.description")," ",(0,t.jsx)("span",{className:"text-xs text-gray-400",children:R("onboarding.description_optional")})]}),(0,t.jsx)(g.g,{placeholder:R("onboarding.description_placeholder"),value:X,onChange:e=>H(e.target.value),className:"rounded-xl resize-none",rows:3})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(k._,{children:[R("settings.delivery_options")," ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,t.jsxs)("label",{className:`flex items-center gap-3 p-4 border-2 rounded-xl cursor-pointer transition-all ${V?"border-green-500 bg-green-50":"border-gray-200 bg-gray-50/50 hover:border-gray-300"}`,children:[(0,t.jsx)("input",{type:"checkbox",checked:V,onChange:e=>W(e.target.checked),className:"w-5 h-5 text-green-600 focus:ring-green-600 rounded"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"w-5 h-5 text-green-600"}),(0,t.jsx)("span",{className:"font-medium",children:R("settings.allow_delivery")})]})]}),(0,t.jsxs)("label",{className:`flex items-center gap-3 p-4 border-2 rounded-xl cursor-pointer transition-all ${Y?"border-green-500 bg-green-50":"border-gray-200 bg-gray-50/50 hover:border-gray-300"}`,children:[(0,t.jsx)("input",{type:"checkbox",checked:Y,onChange:e=>J(e.target.checked),className:"w-5 h-5 text-green-600 focus:ring-green-600 rounded"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Z,{className:"w-5 h-5 text-green-600"}),(0,t.jsx)("span",{className:"font-medium",children:R("settings.allow_pickup")})]})]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:R("onboarding.delivery_options_hint")})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k._,{children:R("onboarding.whatsapp_number")}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(u.I,{value:E?.phone||"",disabled:!0,className:`rounded-xl h-12 bg-gray-50 ${"rtl"===O?"pr-10":"pl-10"}`}),(0,t.jsx)(_.Z,{className:`w-4 h-4 absolute top-4 text-gray-400 ${"rtl"===O?"right-3":"left-3"}`}),(0,t.jsxs)("div",{className:`absolute top-3 bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full flex items-center gap-1 ${"rtl"===O?"left-3":"right-3"}`,children:[(0,t.jsx)(h.Z,{className:"w-3 h-3"})," ",R("onboarding.verified")]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:R("onboarding.linked_account")})]}),(0,t.jsx)(c.z,{onClick:()=>{if(!F.trim()){z({title:R("onboarding.required_field"),description:R("onboarding.enter_store_name"),variant:"destructive"});return}if(!V&&!Y){z({title:R("onboarding.required_field"),description:R("settings.delivery_required_error"),variant:"destructive"});return}a(2)},className:"w-full h-12 rounded-xl bg-green-600 hover:bg-green-700 text-base font-semibold mt-4",children:R("onboarding.next_step")})]}):(0,t.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-right-8 fade-in-0 duration-300",children:[(0,t.jsxs)("label",{className:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-200 rounded-2xl bg-gray-50/50 hover:bg-gray-100 transition-all cursor-pointer group",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let a=e.target.files?.[0];if(a){er(a);let e=new FileReader;e.onloadend=()=>{en(e.result)},e.readAsDataURL(a)}},className:"hidden"}),(0,t.jsxs)("div",{className:"relative w-24 h-24 mb-4",children:[et?(0,t.jsx)(P(),{src:et,alt:"Logo preview",fill:!0,className:"object-cover rounded-full border-4 border-white shadow-md"}):(0,t.jsx)("div",{className:"w-full h-full rounded-full bg-white flex items-center justify-center border-2 border-green-100 shadow-sm group-hover:border-green-200 transition-colors",children:(0,t.jsx)(w.Z,{className:"w-8 h-8 text-green-600 opacity-50 group-hover:opacity-100 transition-opacity"})}),(0,t.jsx)("div",{className:`absolute bottom-0 p-1.5 bg-green-600 rounded-full text-white shadow-lg group-hover:bg-green-700 transition-colors ${"rtl"===O?"left-0":"right-0"}`,children:(0,t.jsx)(w.Z,{className:"w-4 h-4"})})]}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600 group-hover:text-green-700 transition-colors",children:R("onboarding.upload_logo")}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:R("onboarding.logo_recommended")})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k._,{children:R("onboarding.support_email")}),(0,t.jsx)(u.I,{type:"email",placeholder:R("onboarding.support_email_placeholder"),value:es,onChange:e=>eo(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k._,{className:"text-xs text-gray-500 uppercase font-semibold",children:R("onboarding.facebook")}),(0,t.jsx)(u.I,{placeholder:"facebook.com/...",value:ei,onChange:e=>ed(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k._,{className:"text-xs text-gray-500 uppercase font-semibold",children:R("onboarding.instagram")}),(0,t.jsx)(u.I,{placeholder:"instagram.com/...",value:el,onChange:e=>ec(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k._,{className:"text-xs text-gray-500 uppercase font-semibold",children:R("onboarding.twitter")}),(0,t.jsx)(u.I,{placeholder:"twitter.com/...",value:eu,onChange:e=>eg(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k._,{className:"text-xs text-gray-500 uppercase font-semibold",children:R("onboarding.tiktok")}),(0,t.jsx)(u.I,{placeholder:"tiktok.com/@...",value:eb,onChange:e=>ep(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,t.jsx)(k._,{className:"text-xs text-gray-500 uppercase font-semibold",children:R("onboarding.location")}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(u.I,{placeholder:"https://maps.google.com/...",value:em,onChange:e=>eh(e.target.value),className:"rounded-xl"}),(0,t.jsx)(c.z,{type:"button",variant:"outline",onClick:handleGetLocation,className:"rounded-xl shrink-0",title:R("onboarding.get_current_location"),children:(0,t.jsx)(v.Z,{className:"w-4 h-4"})})]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(c.z,{variant:"outline",onClick:()=>a(1),className:"h-12 w-12 rounded-xl border-gray-200 p-0 shrink-0",children:(0,t.jsx)(j.Z,{className:`w-5 h-5 ${"rtl"===O?"rotate-180":""}`})}),(0,t.jsx)(c.z,{onClick:handleSubmit,disabled:r,className:"flex-1 h-12 rounded-xl bg-green-600 hover:bg-green-700 text-base font-semibold",children:r?R("onboarding.creating_store"):R("onboarding.launch_store")})]})]})})]})]})}},15246:(e,a,r)=>{"use strict";function slugify(e){if(!e)return"";let a={ا:"a",أ:"a",إ:"e",آ:"a",ء:"a",ب:"b",ت:"t",ث:"th",ج:"g",ح:"7",خ:"5",د:"d",ذ:"th",ر:"r",z:"z",ز:"z",س:"s",ش:"sh",ص:"s",ض:"d",ط:"t",ظ:"z",ع:"3",غ:"gh",ف:"f",ق:"q",ك:"k",ل:"l",m:"m",م:"m",ن:"n",ه:"h",و:"w",ي:"y",ى:"a",ة:"a","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","؟":"","،":"-","؛":""," ":"-"},r=e.split("").map(e=>a[e]||e).join("");return(r=r.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""))?r:"store-"+Math.random().toString(36).substring(2,8)}r.d(a,{l:()=>slugify})},97487:(e,a,r)=>{"use strict";r.d(a,{Z:()=>t.useLanguage});var t=r(46827)},60936:(e,a,r)=>{"use strict";r.r(a),r.d(a,{createStore:()=>createStore,getStoreForCurrentUser:()=>getStoreForCurrentUser,regenerateStoreQR:()=>regenerateStoreQR});var t=r(58081),n=r(27840),s=r(82610),o=r(98370),i=r.n(o);async function createStore(e,a){let r=await (0,s.getSession)();if(!r||!r.id)return{error:"Unauthorized"};let t=(0,n.getSupabaseAdmin)(),{data:o,error:d}=await t.from("users").select("id").eq("id",r.id).single();if(d||!o)return console.error("User check failed:",d),{error:"User record mismatch. Please log out and log in again."};let l=a.get("name"),c=a.get("slug"),u=a.get("description"),g=a.get("whatsapp_number"),b=a.get("default_language"),p=a.get("logo_url"),m=a.get("email"),h=a.get("facebook_url"),f=a.get("instagram_url"),x=a.get("twitter_url"),v=a.get("tiktok_url"),_=a.get("location_url"),w="true"===a.get("allow_delivery"),j="true"===a.get("allow_pickup");try{let e=process.env.NEXT_PUBLIC_SITE_URL||"https://whatsou.com",{data:a,error:n}=await t.from("stores").insert({user_id:r.id,name:l,slug:c,description:u||null,whatsapp_number:g,default_language:b,logo_url:p||null,email:m||null,facebook_url:h||null,instagram_url:f||null,twitter_url:x||null,tiktok_url:v||null,location_url:_||null,allow_delivery:w,allow_pickup:j}).select().single();if(n)throw n;let s=`${e}/go/${a.id}`,o=await i().toDataURL(s),{error:d}=await t.from("stores").update({qr_code:o}).eq("id",a.id);return d&&console.error("Failed to update store with QR:",d),{success:!0,store:{...a,qr_code:o}}}catch(e){return console.error("Create store error:",e),{error:e.message}}}async function regenerateStoreQR(e){let a=await (0,s.getSession)();if(!a||!a.id)return{error:"Unauthorized"};let r=(0,n.getSupabaseAdmin)(),{data:t,error:o}=await r.from("stores").select("id, user_id").eq("id",e).single();if(o||!t)return{error:"Store not found"};if(t.user_id!==a.id)return{error:"Unauthorized"};let d=process.env.NEXT_PUBLIC_SITE_URL||"https://whatsou.com",l=`${d}/go/${t.id}`,c=await i().toDataURL(l),{error:u}=await r.from("stores").update({qr_code:c}).eq("id",e);return u?{error:u.message}:{success:!0,qr_code:c}}async function getStoreForCurrentUser(){let e=await (0,s.getSession)();if(!e||!e.id)return{error:"Unauthorized",debug_session:e};let a=(0,n.getSupabaseAdmin)(),{data:r,error:t}=await a.from("stores").select("*").eq("user_id",e.id).maybeSingle();return t?{error:`DB Error: ${t.message}`,debug_session:e}:{store:r,debug_session:e}}(0,r(89635).ensureServerEntryExports)([createStore,regenerateStoreQR,getStoreForCurrentUser]),(0,t.createActionProxy)("352429c5adab088f0a38a8877021dd6fceb97eb0",null,createStore),(0,t.createActionProxy)("f7b5cdc95bc89222d92deaf1da2084c26b2dcda0",null,regenerateStoreQR),(0,t.createActionProxy)("25b98238d93637f90585aed364c92879b0673db2",null,getStoreForCurrentUser)},56859:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$typeof:()=>o,__esModule:()=>s,default:()=>d});var t=r(64074);let n=(0,t.createProxy)(String.raw`D:\whatsou\apps\web\app\onboarding\page.tsx`),{__esModule:s,$$typeof:o}=n,i=n.default,d=i}};var a=require("../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),r=a.X(0,[771,7124,4304,6819,9328,1980,7182,8721,3532,1026,9640,7340,3517,8444,9406,7953,2364,2428],()=>__webpack_exec__(19870));module.exports=r})();
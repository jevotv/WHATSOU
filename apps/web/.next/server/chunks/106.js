"use strict";exports.id=106,exports.ids=[106],exports.modules={70106:(e,t,r)=>{r.d(t,{Q:()=>withAuth});var n=r(70914),s=r(42719);async function withAuth(e,t){let r=e.headers.get("Authorization");if(!r?.startsWith("Bearer "))return n.Z.json({error:"Unauthorized - No token provided"},{status:401});let o=r.substring(7),i=await (0,s.W)(o);return i?t(e,i):n.Z.json({error:"Unauthorized - Invalid or expired token"},{status:401})}},42719:(e,t,r)=>{r.d(t,{W:()=>verifyToken,f:()=>signToken});var n=r(37200),s=r(24133);let o=new TextEncoder().encode(process.env.JWT_SECRET||"fallback-secret-change-in-production");async function signToken(e,t){let r=await new n.N({userId:e,phone:t}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(o);return r}async function verifyToken(e){try{let{payload:t}=await (0,s._)(e,o);return{userId:t.userId,phone:t.phone}}catch{return null}}}};
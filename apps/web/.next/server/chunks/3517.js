exports.id=3517,exports.ids=[3517],exports.modules={68345:(e,t,r)=>{Promise.resolve().then(r.bind(r,86937)),Promise.resolve().then(r.bind(r,10433)),Promise.resolve().then(r.bind(r,55621)),Promise.resolve().then(r.bind(r,65714)),Promise.resolve().then(r.bind(r,27973)),Promise.resolve().then(r.t.bind(r,22600,23)),Promise.resolve().then(r.bind(r,46827))},97534:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,35146,23)),Promise.resolve().then(r.t.bind(r,21725,23)),Promise.resolve().then(r.t.bind(r,67541,23)),Promise.resolve().then(r.t.bind(r,37732,23)),Promise.resolve().then(r.t.bind(r,37465,23)),Promise.resolve().then(r.t.bind(r,98336,23))},86937:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CapacitorProvider:()=>CapacitorProvider});var o=r(84196),a=r(78726),s=r(52065),i=r(73154),n=r(58780),l=r(74555),d=r(65714),c=r(25413),u=r(41237),p=r(80819),_=r(19635),g=r(34105),m=r(2420);function CapacitorProvider({children:e}){let{user:t}=(0,d.useAuth)(),h=(0,l.useRouter)(),{toast:f}=(0,c.pm)(),[y,b]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!0),S=(0,a.useRef)(Date.now()),x=(0,a.useRef)(!1),checkBiometricLock=async()=>{if(!s.Capacitor.isNativePlatform()){w(!1);return}if(!x.current)try{let{value:e}=await p.u.get({key:"biometric_enabled"});if("true"===e){b(!0),w(!1),x.current=!0;try{await _.Hc.verifyIdentity({reason:"Unlock Dashboard",title:"Authentication Required",subtitle:"Verify your identity to access the dashboard",description:""}),b(!1)}catch(e){console.error("Biometric verify failed",e)}finally{setTimeout(()=>{x.current=!1},500)}}else w(!1)}catch(e){console.error("Biometric pref check failed",e),w(!1)}};return((0,a.useEffect)(()=>{if(s.Capacitor.isNativePlatform()){checkBiometricLock();let updateBadgeCount=async()=>{try{let{getOrdersCount:e}=await Promise.all([r.e(3532),r.e(1796)]).then(r.bind(r,83654)),{count:t}=await e();if(void 0!==t)try{await u.C.set({count:t})}catch(e){console.warn("Badge set failed",e)}}catch(e){console.error("Error setting badge:",e)}};n.g.addListener("appStateChange",({isActive:e})=>{if(e){updateBadgeCount();let e=Date.now()-S.current;e>5e3&&checkBiometricLock()}else S.current=Date.now()}),n.g.addListener("appUrlOpen",async e=>{let t=new URL(e.url);t.pathname&&t.pathname.startsWith("/dashboard")&&h.push(t.pathname+t.search)});let setupPushNotifications=async()=>{try{let e=await i.V.checkPermissions();if("prompt"===e.receive&&(e=await i.V.requestPermissions()),"granted"!==e.receive)return;await i.V.register(),i.V.addListener("registration",async e=>{if(console.log("Push Registration Success",e.value),t?.id){let{saveFcmToken:t}=await Promise.all([r.e(3532),r.e(7181)]).then(r.bind(r,57181)),o=await t(e.value);o.error?(console.error("Error saving FCM token:",o.error),f({title:"Token Save Failed",description:o.error,variant:"destructive"})):console.log("FCM token saved successfully")}}),i.V.addListener("registrationError",e=>{console.error("Push registration error: ",e),f({title:"Push Error",description:"Google Play Services likely missing or updated required.",variant:"destructive"})}),i.V.addListener("pushNotificationReceived",e=>{f({title:e.title||"New Notification",description:e.body})}),i.V.addListener("pushNotificationActionPerformed",e=>{let t=e.notification.data;t?.url?h.push(t.url):t?.orderId?h.push(`/dashboard/orders/${t.orderId}`):h.push("/dashboard")})}catch(e){console.error("Push notification setup failed:",e)}};return t&&(setupPushNotifications(),updateBadgeCount()),()=>{n.g.removeAllListeners(),i.V.removeAllListeners()}}w(!1)},[t,h,f]),v&&s.Capacitor.isNativePlatform())?(0,o.jsx)("div",{className:"min-h-screen bg-white"}):y?(0,o.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 p-4 space-y-6",children:[(0,o.jsx)("div",{className:"bg-green-100 p-6 rounded-full animate-bounce",children:(0,o.jsx)(g.Z,{className:"w-12 h-12 text-green-600"})}),(0,o.jsxs)("div",{className:"text-center space-y-2",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Locked"}),(0,o.jsx)("p",{className:"text-gray-500",children:"Please verify your identity to continue"})]}),(0,o.jsx)(m.z,{onClick:checkBiometricLock,className:"w-full max-w-xs h-12 rounded-xl bg-green-600 hover:bg-green-700 text-lg font-semibold",children:"Unlock"})]}):(0,o.jsx)(o.Fragment,{children:e})}},10433:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MetaPixelProvider:()=>MetaPixelProvider});var o=r(84196),a=r(74555),s=r(78726);function MetaPixelProvider({children:e}){let t=(0,a.usePathname)(),r=(0,a.useSearchParams)();return(0,s.useEffect)(()=>{},[t,r]),(0,o.jsx)(o.Fragment,{children:e})}},2420:(e,t,r)=>{"use strict";r.d(t,{d:()=>l,z:()=>d});var o=r(84196),a=r(78726),s=r(50120),i=r(24552),n=r(42135);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...i},d)=>{let c=a?s.g7:"button";return(0,o.jsx)(c,{className:(0,n.cn)(l({variant:t,size:r,className:e})),ref:d,...i})});d.displayName="Button"},55621:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Toaster:()=>Toaster});var o=r(84196),a=r(25413),s=r(78726),i=r(16815),n=r(24552),l=r(64463),d=r(42135);let c=i.zt,u=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.l_,{ref:r,className:(0,d.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));u.displayName=i.l_.displayName;let p=(0,n.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),_=s.forwardRef(({className:e,variant:t,...r},a)=>(0,o.jsx)(i.fC,{ref:a,className:(0,d.cn)(p({variant:t}),e),...r}));_.displayName=i.fC.displayName;let g=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.aU,{ref:r,className:(0,d.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));g.displayName=i.aU.displayName;let m=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.x8,{ref:r,className:(0,d.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:(0,o.jsx)(l.Z,{className:"h-4 w-4"})}));m.displayName=i.x8.displayName;let h=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.Dx,{ref:r,className:(0,d.cn)("text-sm font-semibold",e),...t}));h.displayName=i.Dx.displayName;let f=s.forwardRef(({className:e,...t},r)=>(0,o.jsx)(i.dk,{ref:r,className:(0,d.cn)("text-sm opacity-90",e),...t}));function Toaster(){let{toasts:e}=(0,a.pm)();return(0,o.jsxs)(c,{children:[e.map(function({id:e,title:t,description:r,action:a,...s}){return(0,o.jsxs)(_,{...s,children:[(0,o.jsxs)("div",{className:"grid gap-1",children:[t&&(0,o.jsx)(h,{children:t}),r&&(0,o.jsx)(f,{children:r})]}),a,(0,o.jsx)(m,{})]},e)}),(0,o.jsx)(u,{})]})}f.displayName=i.dk.displayName},25413:(e,t,r)=>{"use strict";r.d(t,{pm:()=>useToast});var o=r(78726);let a=0,s=new Map,addToRemoveQueue=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),dispatch({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},reducer=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?addToRemoveQueue(r):e.toasts.forEach(e=>{addToRemoveQueue(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],n={toasts:[]};function dispatch(e){n=reducer(n,e),i.forEach(e=>{e(n)})}function toast({...e}){let t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),dismiss=()=>dispatch({type:"DISMISS_TOAST",toastId:t});return dispatch({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||dismiss()}}}),{id:t,dismiss,update:e=>dispatch({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function useToast(){let[e,t]=o.useState(n);return o.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast,dismiss:e=>dispatch({type:"DISMISS_TOAST",toastId:e})}}},69211:(e,t,r)=>{"use strict";r.d(t,{h:()=>a}),r(52065);let o=process.env.NEXT_PUBLIC_SITE_URL||"https://whatsou.com",a=new class{setToken(e){this.token=e}getToken(){return this.token,this.token}clearToken(){this.token=null}isAuthenticated(){return!!this.getToken()}async fetch(e,t={}){let r=this.getToken(),a=await fetch(`${o}${e}`,{...t,headers:{"Content-Type":"application/json",...r?{Authorization:`Bearer ${r}`}:{},...t.headers}}),s=await a.json();if(!a.ok)throw 401===a.status&&console.error("API Unauthorized (401) - Token NOT cleared for debugging"),Error(s.error||`API Error: ${a.status}`);return s}get(e){return this.fetch(e,{method:"GET"})}post(e,t){return this.fetch(e,{method:"POST",body:t?JSON.stringify(t):void 0})}put(e,t){return this.fetch(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}delete(e){return this.fetch(e,{method:"DELETE"})}constructor(){this.token=null}}},65714:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthProvider:()=>AuthProvider,useAuth:()=>useAuth});var o=r(84196),a=r(78726),s=r(74555),i=r(69211);let n=(0,a.createContext)({user:null,loading:!0,signIn:async()=>{},signUp:async()=>{},signOut:async()=>{}});function AuthProvider({children:e}){let[t,r]=(0,a.useState)(null),[l,d]=(0,a.useState)(!0),c=(0,s.useRouter)();(0,a.useEffect)(()=>{let checkSession=async()=>{if(!i.h.isAuthenticated()){d(!1);return}try{let e=await i.h.get("/api/auth/session");e.authenticated&&e.user?r(e.user):i.h.clearToken()}catch(e){console.error("Session check failed:",e),i.h.clearToken()}d(!1)};checkSession()},[]);let signIn=async(e,t)=>{let o=await i.h.post("/api/auth/login",{phone:e,password:t});if(o.error)throw Error(o.error);o.token&&(i.h.setToken(o.token),r(o.user)),c.push("/dashboard"),c.refresh()},signUp=async(e,t,o=!0)=>{let a=await i.h.post("/api/auth/signup",{phone:e,password:t,agreedToPrivacy:o});if(a.error)throw Error(a.error);a.token&&(i.h.setToken(a.token),r(a.user)),c.push("/onboarding"),c.refresh()},signOut=async()=>{try{await i.h.post("/api/auth/logout")}catch(e){}i.h.clearToken(),r(null),c.push("/login"),c.refresh()};return(0,o.jsx)(n.Provider,{value:{user:t,loading:l,signIn,signUp,signOut},children:e})}let useAuth=()=>(0,a.useContext)(n)},27973:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CartProvider:()=>CartProvider,useCart:()=>useCart});var o=r(84196),a=r(78726);let s=(0,a.createContext)({items:[],addItem:()=>{},removeItem:()=>{},updateQuantity:()=>{},clearCart:()=>{},totalItems:0,totalPrice:0});function CartProvider({children:e}){let[t,r]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=localStorage.getItem("whatsou_cart");e&&r(JSON.parse(e))},[]),(0,a.useEffect)(()=>{localStorage.setItem("whatsou_cart",JSON.stringify(t))},[t]);let removeItem=(e,t)=>{r(r=>r.filter(r=>!(r.product_id===e&&JSON.stringify(r.selected_options)===JSON.stringify(t))))},i=t.reduce((e,t)=>e+t.quantity,0),n=t.reduce((e,t)=>e+t.price*t.quantity,0);return(0,o.jsx)(s.Provider,{value:{items:t,addItem:e=>{r(t=>{let r=t.findIndex(t=>t.product_id===e.product_id&&JSON.stringify(t.selected_options)===JSON.stringify(e.selected_options));if(r>-1){let o=[...t];return o[r].quantity+=e.quantity,o}return[...t,e]})},removeItem,updateQuantity:(e,t,o)=>{if(o<=0){removeItem(e,t);return}r(r=>r.map(r=>r.product_id===e&&JSON.stringify(r.selected_options)===JSON.stringify(t)?{...r,quantity:o}:r))},clearCart:()=>{r([])},totalItems:i,totalPrice:n},children:e})}let useCart=()=>(0,a.useContext)(s)},42135:(e,t,r)=>{"use strict";r.d(t,{cn:()=>cn});var o=r(74693),a=r(16706);function cn(...e){return(0,a.m6)((0,o.W)(e))}},46827:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LanguageProvider:()=>LanguageProvider,useLanguage:()=>useLanguage});var o=r(84196),a=r(78726);let s=JSON.parse('{"common":{"loading":"Loading...","notes":"Notes","error":"Error","success":"Success","save":"Save","saving":"Saving...","back":"Back","powered_by":"Powered by WhatSou","cancel":"Cancel","currency":"EGP","download":"Download","copyright":"\xa9 {year} {storeName}. All rights reserved."},"auth":{"login_title":"Welcome back","login_subtitle":"Sign in to your account","phone_label":"WhatsApp Number","phone_placeholder":"01000000000","password_label":"Password","confirm_password_label":"Confirm Password","password_placeholder":"••••••••","sign_in":"Sign in","signing_in":"Signing in...","no_account":"Don\'t have an account?","sign_up_link":"Sign up","register_title":"Create an account","register_subtitle":"Start your 14-day free trial","store_name_label":"Store Name","store_name_placeholder":"My Awesome Store","create_account":"Create account","creating_account":"Creating account...","has_account":"Already have an account?","sign_in_link":"Sign in","agree_privacy":"I agree to the","privacy_policy":"Privacy Policy"},"onboarding":{"step1_title":"Tell us about your store","step1_desc":"Step 1 of 2: Basic Information","step2_title":"Customize your brand","step2_desc":"Step 2 of 2: Branding & Socials","store_name":"Store Name","store_url":"URL: whatsou.com/{slug}","default_language":"Default Language","english":"English","arabic":"العربية","description":"Description","description_optional":"(Optional)","description_placeholder":"Describe your store...","whatsapp_number":"WhatsApp Number","verified":"Verified","linked_account":"Linked to your account registration","next_step":"Next Step","upload_logo":"Upload Store Logo","logo_recommended":"Recommended: 400x400px","support_email":"Support Email","support_email_placeholder":"support@example.com","facebook":"Facebook","instagram":"Instagram","twitter":"Twitter / X","tiktok":"TikTok","launch_store":"Launch Store","creating_store":"Creating Store...","required_field":"Required Field","enter_store_name":"Please enter a store name.","logo_upload_warning":"Logo upload warning","logo_upload_failed":"Failed to upload logo, continuing without it.","store_name_taken":"Store name taken","store_name_taken_desc":"Please choose a different store name","store_created":"Store created!","welcome_message":"Welcome to WhatSou","location":"Location (Google Maps Link)","get_current_location":"Get current location","geolocation_not_supported":"Geolocation is not supported by your browser.","locating":"Locating...","getting_location":"Getting your current location...","location_found":"Location found!","location_set":"Location URL has been set.","location_error":"Failed to get location.","location_permission_denied":"Location access denied. Please enable permissions.","location_unavailable":"Location information is unavailable.","location_timeout":"The request to get user location timed out.","delivery_options_hint":"Select at least one order fulfillment method"},"dashboard":{"welcome":"Welcome back, {name}!","overview":"Overview","total_sales":"Total Sales","total_orders":"Total Orders","total_products":"Total Products","recent_orders":"Recent Orders","view_all":"View All","products":"Products","add_product":"Add Product","settings":"Settings","logout":"Logout","nav_orders":"Orders","nav_home":"Home","nav_customers":"Customers","no_orders":"No orders yet","no_products":"No products yet","add_first_product":"Add Your First Product","start_selling":"Add your first product to start selling on WhatsApp","copy_link":"Copy Store","link_copied":"Link copied!","link_copied_desc":"Your store link has been copied to clipboard","products_count":"{count} products in your catalog","search_products":"Search products...","whatsapp_commerce":"WhatsApp Commerce Platform","no_qr_code":"No QR code available for this store.","share":"Share","share_link":"Share Link","share_qr":"Share QR Code","product_added_desc":"Product has been added to your store","product_updated_desc":"Product has been updated successfully","delete_product_desc":"Product has been removed from your store","filter_out_of_stock":"Out of Stock","filter_all":"All Time","filter_today":"Today","filter_yesterday":"Yesterday","filter_last_7_days":"Last 7 Days","filter_last_30_days":"Last 30 Days","search_orders":"Search orders...","search_customers":"Search customers...","filter_delivery_type":"Delivery Type","filter_all_types":"All","filter_delivery":"Delivery","filter_pickup":"Pickup","chat_support":"Chat with Support","install_app":"Install App"},"customers":{"orders":"Orders","delivery_address":"Delivery Address","order_items":"Order Items","no_customers":"No customers found yet."},"products":{"add_image":"Add Image","add_first_image":"Add main Image","alt_text_placeholder":"Alt Text","title":"Products","add_new":"Add New Product","edit_product":"Edit Product","delete_product":"Delete Product","delete_confirm":"Are you sure you want to delete this product?","name_label":"Product Name","name_placeholder":"e.g. Summer T-Shirt","description_label":"Description","description_placeholder":"Describe your awesome product...","price_label":"Price","original_price_label":"Original Price (Optional)","stock_label":"Stock Quantity","unlimited_stock":"Unlimited Stock","category_label":"Category","category_placeholder":"Select or type a category","image_label":"Product Image","images_label":"Product Images","drag_drop":"Drag & drop images here","options_label":"Product Options","add_option":"Add Option","option_name":"Option Name","option_values":"Option Values","option_name_placeholder":"e.g. Size, Color","option_values_placeholder":"e.g. S, M, L (comma separated)","option_values_hint":"Type values separated by comma (e.g. Red, Blue, Green)","variants_label":"Variants","manage_variants":"Manage Variants","options_available":"{count} options available","variant_image":"Image","default_image":"Default"},"settings":{"danger_zone_desc":"Be careful after deleting your account, you will not be able to recover it.","delete_account_title":"Delete Account","title":"Store Settings","identity":"Store Identity","store_name":"Store Name","description":"Description","change_logo":"Change Logo","contact_info":"Contact Information","whatsapp":"WhatsApp Number","whatsapp_desc":"This number receives order notifications","email":"Support Email","social_media":"Social Media","default_language":"Default Store Language","english":"EN","arabic":"العربيه","save_success":"Settings saved successfully","saved":"Settings saved!","saved_desc":"Your store settings have been updated","facebook":"Facebook","instagram":"Instagram","twitter":"Twitter / X","tiktok":"TikTok","character_limit":"{current}/{max} characters","language_help":"The default language visitors will see when they first visit your store.","delivery_options":"Delivery Options","allow_delivery":"Home Delivery","allow_delivery_desc":"Enable delivery to customers - address will be required","allow_pickup":"Pick up / In-store","allow_pickup_desc":"Allow customers to pick up from your store","delivery_required_error":"At least one delivery option must be enabled","danger_zone":"Danger Zone","delete_account":"Delete Account","delete_warning":"Once you delete your account, there is no going back. All your data will be permanently removed.","confirm_delete":"Delete Your Account?","delete_consequences":"This action is permanent and cannot be undone:","delete_store":"Your store will be deleted","delete_products":"All products will be removed","delete_orders":"Order history will be erased","delete_subscription":"Your subscription will be cancelled","delete_reason_label":"Why are you leaving?","delete_reason_placeholder":"Please tell us why you want to delete your account...","delete_reason_required":"Please provide a reason for deletion","delete_permanently":"Delete Permanently"},"storefront":{"search_placeholder":"Search products...","all_categories":"All","no_products":"No products found","items_count":"{count} Items","add_to_cart":"Add to Cart","select_options":"Select Options","admin_viewing_store":"You are viewing your store","go_to_dashboard":"Go to Dashboard","out_of_stock":"Out of Stock","in_stock":"In Stock","items_in_stock":"{count} items in stock","select_options_availability":"Select options to see availability","starting_from":"Starting from","sku":"SKU","quantity":"Quantity","variant_unavailable":"This combination is not available","variant_selected":"✓ {options} - EGP {price}","added_to_cart":"Added to cart!","added_to_cart_desc":"{quantity} {name} added to your cart","not_enough_stock":"Not enough stock","not_enough_stock_desc":"Only {count} available","missing_options":"Please select all options","price":"EGP","missing_options_desc":"You must choose a value for each option","filters":"Filters","price_range":"Price Range","show_results":"Show Results","clear_all":"Clear All","sort_by":"Sort By","sort_price_asc":"Price: Low to High","sort_price_desc":"Price: High to Low","sort_newest":"Newest","sort_best_selling":"Best Selling","no_products_found":"No products found","no_products_found_desc":"Try adjusting your filters or search query","clear_filters":"Clear Filters"},"filters":{"show_results":"Show Results","clear_all":"Clear All"},"cart":{"title":"Your Cart","checkout_title":"Checkout","empty":"Your cart is empty","total":"Total","proceed":"Proceed to Checkout","confirm_order":"Confirm Order","processing":"Processing...","free":"Free shipping","shipping":"Shipping","subtotal":"Sub Total","back_to_cart":"Back to Cart","missing_info":"Missing information","missing_info_desc":"Please fill in all fields","order_placed":"Order placed!","order_placed_desc":"Redirecting to WhatsApp...","form":{"name":"Your Name","name_placeholder":"John Doe","phone":"Phone Number","phone_placeholder":"+1234567890","address":"Delivery Address","address_placeholder":"123 Main St, City, State","notes":"Notes","notes_placeholder":"Any special instructions...","summary":"Order Summary"},"delivery_type":"Delivery Method","home_delivery":"Home Delivery","pickup":"Pick up"},"whatsapp":{"greeting":"\uD83C\uDF89 Hello {storeName}! I have a new order from WhatSou","personal_details":"\uD83D\uDC64 Personal Details","name":"• \uD83D\uDC64 Name: {name}","phone":"• \uD83D\uDCF1 Phone: {phone}","address":"• \uD83C\uDFE0 Address: {address}","notes":"• \uD83D\uDCDD Notes: {notes}","order_details":"\uD83D\uDED2 Order Details:","separator":"━━━━━━━━━━━━━","product_prefix":"\uD83C\uDFF7️ ","quantity":"\uD83D\uDD22 Quantity: ({quantity}) pieces","price":"\uD83D\uDCB5 Price: {price} EGP","total":"\uD83D\uDCB5 Total Amount: {total} EGP","footer":"\uD83D\uDE9A Please confirm the order and start preparation. ⚡","pickup_order":"• \uD83C\uDFEA Pickup from store"},"error":{"page_not_found":"Page Not Found","page_not_found_desc":"Sorry, the page you\'re looking for doesn\'t exist or has been moved.","back_to_dashboard":"Back to Dashboard","back_to_store":"Back to Store","error_code":"Error 404"},"pwa":{"install_title":"Install WhatSou App","not_install_subtitle":"App is already installed or installation is not available.","install_subtitle":"For a better experience","install_button":"Install","guide_button":"Guide","ios_guide_title":"Install on iPhone","step_1_label":"Step 1","step_1_text":"Tap the Share button in the menu bar.","step_2_label":"Step 2","step_2_text":"Scroll down and tap Add to Home Screen.","step_3_label":"Step 3","step_3_text":"Tap Add in the top right corner.","got_it":"Got it"}}'),i=JSON.parse('{"common":{"loading":"جاري التحميل...","notes":"ملاحظات","error":"خطأ","success":"تم بنجاح","save":"حفظ","saving":"جاري الحفظ...","back":"رجوع","powered_by":"مشغل بواسطة WhatSou","currency":"ج.م","cancel":"إلغاء","download":"تحميل","copyright":"\xa9 {year} {storeName}. جميع الحقوق محفوظة."},"auth":{"login_title":"مرحباً بعودتك","login_subtitle":"سجل الدخول لحسابك","phone_label":"رقم الواتساب","phone_placeholder":"01xxxxxxxxx","password_label":"كلمة المرور","confirm_password_label":"تأكيد كلمة المرور","password_placeholder":"••••••••","sign_in":"تسجيل الدخول","signing_in":"جاري الدخول...","no_account":"ليس لديك حساب؟","sign_up_link":"أنشئ حساب","register_title":"إنشاء حساب جديد","register_subtitle":"ابدأ فترتك التجربة المجانية لمدة 14 يوم","store_name_label":"اسم المتجر","store_name_placeholder":"متجري الرائع","create_account":"إنشاء حساب","creating_account":"جاري الإنشاء...","has_account":"لديك حساب بالفعل؟","sign_in_link":"سجل الدخول","agree_privacy":"أوافق على","privacy_policy":"سياسة الخصوصية"},"onboarding":{"step1_title":"أخبرنا عن متجرك","step1_desc":"الخطوة 1 من 2: المعلومات الأساسية","step2_title":"خصص علامتك التجارية","step2_desc":"الخطوة 2 من 2: الهوية والتواصل","store_name":"اسم المتجر","store_url":"الرابط: whatsou.com/{slug}","default_language":"لغة المتجر","english":"English","arabic":"العربية","description":"وصف المتجر","description_optional":"(اختياري)","description_placeholder":"اكتب وصفاً مختصراً لمتجرك...","whatsapp_number":"رقم الواتساب","verified":"تم التحقق","linked_account":"مرتبط بحسابك المسجل","next_step":"الخطوة التالية","upload_logo":"رفع شعار المتجر","logo_recommended":"يفضل مقاس: 400x400px","support_email":"البريد الإلكتروني للدعم","support_email_placeholder":"name@example.com","facebook":"فيسبوك","instagram":"إنستغرام","twitter":"تويتر / X","tiktok":"تيك توك","launch_store":"إطلاق المتجر","creating_store":"جاري إنشاء المتجر...","required_field":"حقل مطلوب","enter_store_name":"برجاء كتابة اسم المتجر","logo_upload_warning":"تنبيه رفع الشعار","logo_upload_failed":"فشل رفع الشعار، سيتم المتابعة بدونه.","store_name_taken":"اسم المتجر مستخدم","store_name_taken_desc":"برجاء اختيار اسم آخر","store_created":"تم إنشاء المتجر!","welcome_message":"مرحباً بك في WhatSou","location":"الموقع (رابط خرائط جوجل)","get_current_location":"تحديد موقعي الحالي","geolocation_not_supported":"المتصفح لا يدعم تحديد الموقع.","locating":"جاري التحديد...","getting_location":"جاري الحصول على موقعك الحالي...","location_found":"تم تحديد الموقع!","location_set":"تم وضع رابط الموقع بنجاح.","location_error":"فشل تحديد الموقع.","location_permission_denied":"تم رفض طلب الموقع. برجاء تفعيل الصلاحيات.","location_unavailable":"معلومات الموقع غير متاحة.","location_timeout":"انتهت مهلة طلب الموقع.","delivery_options_hint":"اختر طريقة واحدة على الأقل لاستلام الطلبات"},"dashboard":{"welcome":"أهلاً، {name}!","overview":"نظرة عامة","total_sales":"إجمالي المبيعات","total_orders":"إجمالي الطلبات","total_products":"عدد المنتجات","recent_orders":"أحدث الطلبات","view_all":"عرض الكل","products":"المنتجات","add_product":"أضف منتج","settings":"الإعدادات","logout":"خروج","nav_orders":"الطلبات","nav_home":"الرئيسية","nav_customers":"العملاء","no_orders":"لا توجد طلبات","no_products":"لا توجد منتجات بعد","add_first_product":"أضف منتجك الأول","start_selling":"أضف منتجك الأول لتبدأ البيع على واتساب","copy_link":"نسخ المتجر","link_copied":"تم النسخ!","link_copied_desc":"تم نسخ رابط متجرك للحافظة","products_count":"{count} منتج في الكتالوج","search_products":"ابحث عن منتجات...","whatsapp_commerce":"منصة التجارة عبر واتساب","no_qr_code":"لا يوجد رمز QR لهذا المتجر.","share":"مشاركة","share_link":"مشاركة الرابط","share_qr":"مشاركة رمز QR","product_added_desc":"تم إضافة المنتج إلى متجرك","product_updated_desc":"تم تحديث المنتج بنجاح","delete_product_desc":"تمت إزالة المنتج من متجرك","filter_out_of_stock":"نفذت الكمية","filter_all":"كل الوقت","filter_today":"اليوم","filter_yesterday":"أمس","filter_last_7_days":"آخر ٧ أيام","filter_last_30_days":"آخر ٣٠ يوم","search_orders":"بحث في الطلبات...","search_customers":"بحث عن عميل...","filter_delivery_type":"نوع الاستلام","filter_all_types":"الكل","filter_delivery":"توصيل","filter_pickup":"استلام من الفرع","chat_support":"تحدث مع الدعم","install_app":"تثبيت التطبيق"},"customers":{"orders":"طلبات","delivery_address":"العنوان","order_items":"المنتجات","no_customers":"لا يوجد عملاء"},"products":{"add_image":"إضافة صورة","add_first_image":"إضافة الصورة الرئيسية","alt_text_placeholder":"النص البديل","title":"المنتجات","add_new":"أضف منتج جديد","edit_product":"تعديل المنتج","delete_product":"حذف المنتج","delete_confirm":"هل أنت متأكد من حذف هذا المنتج؟","name_label":"اسم المنتج","name_placeholder":"مثال: تيشيرت صيفي","description_label":"الوصف","description_placeholder":"أضف وصفاً مميزاً للمنتج...","price_label":"السعر","original_price_label":"السعر الأصلي (اختياري)","stock_label":"الكمية المتاحة","unlimited_stock":"كمية غير محدودة","category_label":"القسم","category_placeholder":"اختر أو اكتب قسماً","image_label":"صور المنتج","images_label":"صور المنتج","drag_drop":"اسحب الصور هنا","options_label":"خيارات المنتج","add_option":"أضف خيار","option_name":"اسم الخيار","option_values":"قيم الخيار","option_name_placeholder":"مثال: المقاس، اللون","option_values_placeholder":"مثال: أحمر، أزرق، أخضر (مفصولة بفاصلة)","option_values_hint":"اكتب القيم وافصل بينها بفاصلة (مثال: أحمر، أزرق، أخضر)","variants_label":"أنواع المنتج","manage_variants":"إدارة الأنواع","options_available":"{count} خيارات متاحة","variant_image":"صورة","default_image":"افتراضي"},"settings":{"danger_zone_desc":"بعد حذف حسابك، لن تتمكن من استرجاعه.","delete_account_title":"حذف الحساب","title":"إعدادات المتجر","identity":"هوية المتجر","store_name":"اسم المتجر","description":"الوصف","change_logo":"تغيير الشعار","contact_info":"بيانات التواصل","whatsapp":"رقم الواتساب","whatsapp_desc":"هذا الرقم يستقبل إشعارات الطلبات","email":"البريد الإلكتروني للدعم","social_media":"وسائل التواصل الاجتماعي","default_language":"لغة المتجر الافتراضية","english":"EN","arabic":"العربية","save_success":"تم حفظ الإعدادات بنجاح","saved":"تم الحفظ!","saved_desc":"تم تحديث إعدادات متجرك","facebook":"فيسبوك","instagram":"إنستغرام","twitter":"تويتر / X","tiktok":"تيك توك","character_limit":"{current}/{max} حرف","language_help":"اللغة الافتراضية التي سيراها الزوار عند زيارة متجرك لأول مرة.","delivery_options":"خيارات الاستلام","allow_delivery":"توصيل للمنزل","allow_delivery_desc":"تفعيل التوصيل للعملاء - العنوان سيكون إجبارياً","allow_pickup":"استلام من الفرع","allow_pickup_desc":"السماح للعملاء بالاستلام من المحل مباشرة","delivery_required_error":"يجب تفعيل خيار استلام واحد على الأقل","danger_zone":"منطقة الخطر","delete_account":"حذف الحساب","delete_warning":"بمجرد حذف حسابك، لا يمكن التراجع. سيتم حذف جميع بياناتك نهائياً.","confirm_delete":"حذف حسابك؟","delete_consequences":"هذا الإجراء نهائي ولا يمكن التراجع عنه:","delete_store":"سيتم حذف متجرك","delete_products":"سيتم إزالة جميع المنتجات","delete_orders":"سيتم مسح سجل الطلبات","delete_subscription":"سيتم إلغاء اشتراكك","delete_reason_label":"لماذا تريد المغادرة؟","delete_reason_placeholder":"يرجى إخبارنا لماذا تريد حذف حسابك...","delete_reason_required":"يرجى تقديم سبب للحذف","delete_permanently":"حذف نهائياً"},"storefront":{"search_placeholder":"ابحث عن منتجات...","all_categories":"الكل","no_products":"لا توجد منتجات","items_count":"{count} منتج","add_to_cart":"أضف للسلة","select_options":"تحديد الخيارات","admin_viewing_store":"أنت تشاهد متجرك الآن","go_to_dashboard":"الذهاب للوحة التحكم","out_of_stock":"نفذت الكمية","in_stock":"متوفر","items_in_stock":"{count} قطعة متوفرة","select_options_availability":"اختر الخيارات لمعرفة التوفر","starting_from":"يبدأ من","sku":"كود المنتج","quantity":"الكمية","variant_unavailable":"هذا الاختيار غير متاح","variant_selected":"✓ {options} - {price} ج.م","added_to_cart":"تمت الإضافة للسلة!","added_to_cart_desc":"تم إضافة {quantity} {name} لسلتك","not_enough_stock":"الكمية غير متوفرة","not_enough_stock_desc":"المتاح فقط {count}","missing_options":"برجاء اختيار كل الخيارات","price":"جنيه","missing_options_desc":"يجب عليك اختيار قيمة لكل خيار","filters":"فلترة","price_range":"نطاق السعر","show_results":"عرض النتائج","clear_all":"مسح الكل","sort_by":"ترتيب حسب","sort_price_asc":"الأقل سعراً","sort_price_desc":"الأعلى سعراً","sort_newest":"الأحدث","sort_best_selling":"الأكثر مبيعا","no_products_found":"لم يتم العثور على منتجات","no_products_found_desc":"جرب تغيير الفلاتر أو البحث عن شيء آخر","clear_filters":"مسح الفلاتر"},"filters":{"show_results":"عرض النتائج","clear_all":"مسح الكل"},"cart":{"title":"سلة المشتريات","checkout_title":"إتمام الطلب","empty":"سلتك فارغة","total":"الإجمالي","proceed":"إتمام الشراء","confirm_order":"تأكيد الطلب","free":"شحن مجاني","subtotal":"الإجمالي","shipping":"الشحن","processing":"جاري التنفيذ...","back_to_cart":"العودة للسلة","missing_info":"بيانات ناقصة","missing_info_desc":"برجاء ملء جميع البيانات","order_placed":"تم إرسال الطلب!","order_placed_desc":"جاري التحويل للواتساب...","form":{"name":"الاسم *","name_placeholder":"الاسم بالكامل","phone":"رقم الهاتف *","phone_placeholder":"01xxxxxxxxx","address":"العنوان *","address_placeholder":"اسم الشارع، المنطقة، المدينة","notes":"ملاحظات","notes_placeholder":"أي تعليمات خاصة...","summary":"ملخص الطلب"},"delivery_type":"طريقة الاستلام","home_delivery":"توصيل للبيت","pickup":"استلام من الفرع"},"whatsapp":{"greeting":"\uD83C\uDF89 أهلاً يا {storeName}! جالك طلب جديد من WhatSou","personal_details":"\uD83D\uDC64 بياناتي الشخصية","name":"• \uD83D\uDC64 الاسم: {name}","phone":"• \uD83D\uDCF1 الموبايل: {phone}","address":"• \uD83C\uDFE0 العنوان: {address}","notes":"• \uD83D\uDCDD ملاحظات: {notes}","order_details":"\uD83D\uDED2 تفاصيل الأوردر:","separator":"━━━━━━━━━━━━━","product_prefix":"\uD83C\uDFF7️ ","quantity":"\uD83D\uDD22 العدد: ({quantity}) قطع","price":"\uD83D\uDCB5 السعر:  ج.م {price}","total":"\uD83D\uDCB5 المبلغ الإجمالي: ج.م {total}","footer":"\uD83D\uDE9A أرجو تأكيد الطلب وبدء التجهيز. ⚡","pickup_order":"• \uD83C\uDFEA استلام من الفرع"},"error":{"page_not_found":"الصفحة غير موجودة","page_not_found_desc":"عذراً، الصفحة التي تبحث عنها غير موجودة أو تم نقلها.","back_to_dashboard":"العودة للوحة التحكم","back_to_store":"العودة للمتجر","error_code":"خطأ 404"},"pwa":{"install_title":"تثبيت تطبيق WhatSou","install_subtitle":"للحصول على تجربة أفضل","not_install_subtitle":"تطبيق WhatSou مثبت بالفعل أو التثبيت غير متاح.","install_button":"تثبيت","guide_button":"شرح","ios_guide_title":"التثبيت على الآيفون","step_1_label":"الخطوة ١","step_1_text":"اضغط على زر المشاركة في شريط القائمة.","step_2_label":"الخطوة ٢","step_2_text":"انزل لأسفل واضغط إضافة إلى الشاشة الرئيسية.","step_3_label":"الخطوة ٣","step_3_text":"اضغط إضافة في أعلى الشاشة.","got_it":"فهمت"}}'),n=(0,a.createContext)(void 0),l={en:s,ar:i};function LanguageProvider({children:e,defaultLanguage:t="en"}){let[r,s]=(0,a.useState)("en"),[i,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=localStorage.getItem("language");e?s(e):t&&("en"===t||"ar"===t)&&s(t),d(!0)},[t]),(0,a.useEffect)(()=>{i&&(document.documentElement.lang=r,document.documentElement.dir="ar"===r?"rtl":"ltr",localStorage.setItem("language",r))},[r,i]);let getNestedValue=(e,t)=>t.split(".").reduce((e,t)=>e&&e[t],e),c={language:r,direction:"ar"===r?"rtl":"ltr",setLanguage:e=>{s(e)},t:(e,t)=>{let o=getNestedValue(l[r],e);return o?(t&&Object.entries(t).forEach(([e,t])=>{o=o.replace(`{${e}}`,String(t))}),o):(console.warn(`Missing translation for key: ${e}`),e)},dictionary:l[r]};return(0,o.jsx)(n.Provider,{value:c,children:e})}function useLanguage(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}},82610:(e,t,r)=>{"use strict";r.r(t),r.d(t,{changePassword:()=>changePassword,deleteAccount:()=>deleteAccount,getSession:()=>getSession,saveFcmToken:()=>saveFcmToken,signIn:()=>signIn,signOut:()=>signOut,signUp:()=>signUp});var o=r(58081),a=r(18877),s=r(54920),i=r(69450),n=r(27840),l=r(89635);let d="app-session";async function signUp(e){let t=e.get("phone"),r=e.get("password");if(!t||!r)return{error:"Phone and password are required"};let o=(0,n.getSupabaseAdmin)(),{data:l}=await o.from("users").select("id").eq("phone",t).single();if(l)return{error:"User already exists"};let c=await s.default.hash(r,10),{data:u,error:p}=await o.from("users").insert({phone:t,password_hash:c}).select().single();if(p)return console.error("Signup error:",p),{error:"Failed to create user"};let{error:_}=await o.from("subscriptions").insert({user_id:u.id,status:"inactive",is_first_subscription:!0});_&&console.error("Subscription creation error:",_),(0,i.sendNewUserAlert)(u.phone,u.created_at).catch(console.error);let g=JSON.stringify({id:u.id,phone:u.phone}),m=Buffer.from(g).toString("base64");return(0,a.cookies)().set(d,m,{httpOnly:!1,secure:!1,sameSite:"lax",maxAge:604800,path:"/"}),{success:!0,token:m}}async function signIn(e){let t=e.get("phone"),r=e.get("password");if(!t||!r)return{error:"Phone and password are required"};process.env.SUPABASE_SERVICE_ROLE_KEY;let o=(0,n.getSupabaseAdmin)(),{data:i,error:l}=await o.from("users").select("*").eq("phone",t).single();if(l)return{error:`DB Error: ${l.message} (${l.code})`};if(!i)return{error:"User not found"};let c=await s.default.compare(r,i.password_hash);if(!c)return{error:"Password incorrect"};let u=JSON.stringify({id:i.id,phone:i.phone}),p=Buffer.from(u).toString("base64");return(0,a.cookies)().set(d,p,{httpOnly:!1,secure:!1,sameSite:"lax",maxAge:604800,path:"/"}),{success:!0,token:p}}async function signOut(){return(0,a.cookies)().delete(d),{success:!0}}async function getSession(){let e=(0,a.cookies)().get(d);if(!e)return null;try{let{verifyToken:t}=await Promise.all([r.e(5877),r.e(251)]).then(r.bind(r,20251)),o=await t(e.value);if(o)return{id:o.userId,phone:o.phone};let s=Buffer.from(e.value,"base64").toString("utf-8"),i=JSON.parse(s);if("bba49af4-d8d7-44cc-879b-0cb3b9b60538"===i.id)return(0,a.cookies)().delete(d),null;return i}catch(e){return null}}async function changePassword(e){let t=e.get("currentPassword"),r=e.get("newPassword");if(!t||!r)return{error:"Current and new passwords are required"};let o=await getSession();if(!o||!o.id)return{error:"Unauthorized"};let a=(0,n.getSupabaseAdmin)(),{data:i,error:l}=await a.from("users").select("password_hash").eq("id",o.id).single();if(l||!i)return{error:"User not found"};let d=await s.default.compare(t,i.password_hash);if(!d)return{error:"Incorrect current password"};let c=await s.default.hash(r,10),{error:u}=await a.from("users").update({password_hash:c}).eq("id",o.id);return u?(console.error("Password update error:",u),{error:"Failed to update password"}):{success:!0}}async function saveFcmToken(e){let t=await getSession();if(!t||!t.id)return{error:"Unauthorized"};let r=(0,n.getSupabaseAdmin)(),{error:o}=await r.from("users").update({fcm_token:e}).eq("id",t.id);return o?(console.error("FCM token save error:",o),{error:o.message}):{success:!0}}async function deleteAccount(e){let t=await getSession();if(!t?.id)return{error:"Unauthorized"};let o=(0,n.getSupabaseAdmin)();try{let{data:s}=await o.from("users").select("phone").eq("id",t.id).single(),{data:i}=await o.from("stores").select(`
                id,
                name,
                slug,
                logo_url
            `).eq("user_id",t.id).single(),n=[],l=0;if(i){let{data:e}=await o.from("products").select("id, image_url, thumbnail_url").eq("store_id",i.id);n=e||[];let{count:t}=await o.from("orders").select("id",{count:"exact",head:!0}).eq("store_id",i.id);l=t||0}let c=[];for(let e of(i?.logo_url&&c.push(i.logo_url),n))e.image_url&&c.push(e.image_url),e.thumbnail_url&&c.push(e.thumbnail_url);let{error:u}=await o.from("deleted_users").insert({original_user_id:t.id,phone:s?.phone||"unknown",store_name:i?.name||null,store_slug:i?.slug||null,deletion_reason:e,total_orders:l,total_products:n.length});if(u&&console.error("Audit insert error:",u),c.length>0)try{let{deleteMultipleFromR2:e}=await r.e(3883).then(r.bind(r,73883));await e(c)}catch(e){console.error("R2 deletion error:",e)}if(i){let{error:e}=await o.from("stores").delete().eq("id",i.id);if(e)return console.error("Delete store error:",e),{error:"Failed to delete store"}}let{error:p}=await o.from("users").delete().eq("id",t.id);if(p)return console.error("Delete user error:",p),{error:"Failed to delete account"};return(0,a.cookies)().delete(d),{success:!0}}catch(e){return console.error("Account deletion error:",e),{error:e.message||"Failed to delete account"}}}(0,l.ensureServerEntryExports)([signUp,signIn,signOut,getSession,changePassword,saveFcmToken,deleteAccount]),(0,o.createActionProxy)("794157ea47e2106a7052b432086ad1b87e095461",null,signUp),(0,o.createActionProxy)("ba699b676f4f91d1d7d1921ad4b89a747ef10c53",null,signIn),(0,o.createActionProxy)("d625827fa7c2c77be09b75528bdad178aa3c081c",null,signOut),(0,o.createActionProxy)("f2a595d6207f10ec2702e3a63c3639433bdad896",null,getSession),(0,o.createActionProxy)("dac5dc3f6ed84f3fefb6b3b31363644a8fb7a355",null,changePassword),(0,o.createActionProxy)("f5490e7217b4beda3444cfb66f3894e5692d3768",null,saveFcmToken),(0,o.createActionProxy)("b5d5296f57824f20697bf651a3e62d3a07a7262e",null,deleteAccount)},94065:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createProduct:()=>createProduct,deleteProduct:()=>deleteProduct,getCustomers:()=>getCustomers,getOrders:()=>getOrders,getOrdersCount:()=>getOrdersCount,getProductsForStore:()=>getProductsForStore,updateProduct:()=>updateProduct,updateStore:()=>updateStore});var o=r(58081),a=r(82610),s=r(27840),i=r(55806);async function verifyStoreOwnership(e,t){let r=(0,s.getSupabaseAdmin)(),{data:o}=await r.from("stores").select("id, user_id").eq("id",e).single();return o&&o.user_id===t}async function createProduct(e){let t=await (0,a.getSession)();if(!t||!t.id)return{error:"Unauthorized"};if(!e.store_id)return{error:"Store ID required"};if(e.images&&e.images.length>5)return{error:"Maximum 5 images allowed per product"};let r=await verifyStoreOwnership(e.store_id,t.id);if(!r)return{error:"Unauthorized: You do not own this store"};let o=(0,s.getSupabaseAdmin)(),n=e.images&&e.images.length>0?e.images[0].url:null,l=e.images&&e.images.length>0?e.images[0].thumbnailUrl:null,{data:d,error:c}=await o.from("products").insert({store_id:e.store_id,name:e.name,description:e.description,current_price:e.current_price,original_price:e.original_price,category:e.category,quantity:e.quantity,unlimited_stock:e.unlimited_stock,image_url:n,thumbnail_url:l,options:e.options}).select().single();if(c)return console.error("Create product error:",c),{error:c.message};if(e.images&&e.images.length>0){let t=e.images.map((e,t)=>({product_id:d.id,image_url:e.url,thumbnail_url:e.thumbnailUrl,display_order:t,alt_text:e.altText||null})),{error:r}=await o.from("product_images").insert(t);if(r)return console.error("Create images error:",r),{error:"Product created but failed to save images"}}if(e.variants&&e.variants.length>0){let t=e.variants.map(t=>({product_id:d.id,option_values:t.option_values,price:t.price,quantity:t.quantity,unlimited_stock:e.unlimited_stock,sku:t.sku,image_index:t.image_index??null})),{error:r}=await o.from("product_variants").insert(t);if(r)return console.error("Create variants error:",r),{error:"Product created but failed to save variants"}}return(0,i.revalidatePath)("/dashboard"),{success:!0,product:d}}async function updateProduct(e,t){let r=await (0,a.getSession)();if(!r||!r.id)return{error:"Unauthorized"};if(t.images&&t.images.length>5)return{error:"Maximum 5 images allowed per product"};let o=(0,s.getSupabaseAdmin)(),{data:n}=await o.from("products").select("store_id").eq("id",e).single();if(!n)return{error:"Product not found"};let l=await verifyStoreOwnership(n.store_id,r.id);if(!l)return{error:"Unauthorized"};let{data:d}=await o.from("product_images").select("image_url, thumbnail_url").eq("product_id",e),c=new Set(t.images?.map(e=>e.url)||[]);if(d){let e=d.filter(e=>!c.has(e.image_url));for(let t of e)try{let e=new URL(t.image_url),r=e.pathname.split("/products/");if(r.length>1){let e=r[1];await o.storage.from("products").remove([e])}if(t.thumbnail_url){let e=new URL(t.thumbnail_url),r=e.pathname.split("/products/");if(r.length>1){let e=r[1];await o.storage.from("products").remove([e])}}}catch(e){console.error("Failed to delete image from storage:",e)}}let u=t.images&&t.images.length>0?t.images[0].url:null,p=t.images&&t.images.length>0?t.images[0].thumbnailUrl:null,{error:_}=await o.from("products").update({name:t.name,description:t.description,current_price:t.current_price,original_price:t.original_price,category:t.category,quantity:t.quantity,unlimited_stock:t.unlimited_stock,image_url:u,thumbnail_url:p,options:t.options,updated_at:new Date().toISOString()}).eq("id",e);if(_)return{error:_.message};let{error:g}=await o.from("product_images").delete().eq("product_id",e);if(g)return{error:"Failed to update images"};if(t.images&&t.images.length>0){let r=t.images.map((t,r)=>({product_id:e,image_url:t.url,thumbnail_url:t.thumbnailUrl,display_order:r,alt_text:t.altText||null})),{error:a}=await o.from("product_images").insert(r);if(a)return{error:"Failed to save new images"}}if(t.variants&&(await o.from("product_variants").delete().eq("product_id",e),t.variants.length>0)){let r=t.variants.map(r=>({product_id:e,option_values:r.option_values,price:r.price,quantity:r.quantity,unlimited_stock:t.unlimited_stock,sku:r.sku,image_index:r.image_index??null})),{error:a}=await o.from("product_variants").insert(r);if(a)return{error:"Failed to update variants"}}return(0,i.revalidatePath)("/dashboard"),{success:!0}}async function deleteProduct(e){let t=await (0,a.getSession)();if(!t||!t.id)return{error:"Unauthorized"};let r=(0,s.getSupabaseAdmin)(),{data:o}=await r.from("products").select("store_id").eq("id",e).single();if(!o)return{error:"Product not found"};let n=await verifyStoreOwnership(o.store_id,t.id);if(!n)return{error:"Unauthorized"};let{data:l}=await r.from("product_images").select("image_url, thumbnail_url").eq("product_id",e);if(l){let e=[];for(let t of l)try{let r=new URL(t.image_url),o=r.pathname.split("/products/");if(o.length>1&&e.push(o[1]),t.thumbnail_url){let r=new URL(t.thumbnail_url),o=r.pathname.split("/products/");o.length>1&&e.push(o[1])}}catch(e){console.error("Url parsing error",e)}e.length>0&&await r.storage.from("products").remove(e)}let{error:d}=await r.from("products").delete().eq("id",e);return d?{error:d.message}:((0,i.revalidatePath)("/dashboard"),{success:!0})}async function updateStore(e,t){let r=await (0,a.getSession)();if(!r||!r.id)return{error:"Unauthorized"};let o=(0,s.getSupabaseAdmin)(),{data:n,error:l}=await o.from("stores").select("id, user_id").eq("id",e).single();if(l||!n)return{error:"Store not found"};if(n.user_id!==r.id)return{error:"Unauthorized: You do not own this store"};let{error:d}=await o.from("stores").update(t).eq("id",e);return d?(console.error("Store update error:",d),{error:"Failed to update store settings"}):((0,i.revalidatePath)("/dashboard/settings"),(0,i.revalidatePath)("/dashboard"),{success:!0})}async function getCustomers(){let e=await (0,a.getSession)();if(!e||!e.id)return{error:"Unauthorized"};let t=(0,s.getSupabaseAdmin)(),{data:r,error:o}=await t.from("stores").select("id").eq("user_id",e.id).single();if(o||!r)return{error:"Store not found"};let{data:i,error:n}=await t.from("orders").select("customer_name, customer_phone, created_at").eq("store_id",r.id).order("created_at",{ascending:!1});return n?(console.error("Error fetching customers:",n),{error:"Failed to fetch customers"}):{success:!0,data:i}}async function getOrders(){let e=await (0,a.getSession)();if(!e||!e.id)return{error:"Unauthorized"};let t=(0,s.getSupabaseAdmin)(),{data:r,error:o}=await t.from("stores").select("id, allow_delivery, allow_pickup").eq("user_id",e.id).single();if(o||!r)return{error:"Store not found"};let{data:i,error:n}=await t.from("orders").select("*").eq("store_id",r.id).order("created_at",{ascending:!1});return n?(console.error("Error fetching orders:",n),{error:"Failed to fetch orders"}):{success:!0,orders:i,storeSettings:{allow_delivery:r.allow_delivery,allow_pickup:r.allow_pickup}}}async function getOrdersCount(){let e=await (0,a.getSession)();if(!e||!e.id)return{count:0};let t=(0,s.getSupabaseAdmin)(),{data:r}=await t.from("stores").select("id").eq("user_id",e.id).single();if(!r)return{count:0};let{count:o,error:i}=await t.from("orders").select("*",{count:"exact",head:!0}).eq("store_id",r.id);return i?{count:0}:{count:o||0}}async function getProductsForStore(e){let t=await (0,a.getSession)();if(!t||!t.id)return{error:"Unauthorized"};let r=await verifyStoreOwnership(e,t.id);if(!r)return{error:"Unauthorized"};let o=(0,s.getSupabaseAdmin)();try{let{data:t,error:r}=await o.from("products").select("*, images:product_images(*)").eq("store_id",e).order("created_at",{ascending:!1});if(r)throw r;if(t&&t.length>0){let e=t.map(e=>e.id),{data:r}=await o.from("product_variants").select("*").in("product_id",e),a=t.map(e=>({...e,variants:r?.filter(t=>t.product_id===e.id)||[]}));return{success:!0,products:a}}return{success:!0,products:[]}}catch(e){return console.error("Error fetching products:",e),{error:e.message}}}(0,r(89635).ensureServerEntryExports)([createProduct,updateProduct,deleteProduct,updateStore,getCustomers,getOrders,getOrdersCount,getProductsForStore]),(0,o.createActionProxy)("4a527ee583574be2bdf9f2177929a02116078f62",null,createProduct),(0,o.createActionProxy)("062daab9f475cd399623ce936833fde70b64c375",null,updateProduct),(0,o.createActionProxy)("27012f75ad6661d643d69cd56779e93b523e4e74",null,deleteProduct),(0,o.createActionProxy)("9cc01ad5d382d64e5098ab2fcec9ddce5a16badb",null,updateStore),(0,o.createActionProxy)("eae23fc9d6e8db8b55a13f1501c8c092743db0a8",null,getCustomers),(0,o.createActionProxy)("b9b850b25d6da988503c0d70f38405029a471f66",null,getOrders),(0,o.createActionProxy)("a2ed93aa8ca9dc0bc546057e9e58b564fc8002c3",null,getOrdersCount),(0,o.createActionProxy)("ab59a523b5f966d77a2cdbf664645220244c0c9e",null,getProductsForStore)},27734:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>RootLayout,metadata:()=>O});var o=r(25620);r(20001);var a=r(94347),s=r.n(a),i=r(64074);let n=(0,i.createProxy)(String.raw`D:\whatsou\apps\web\lib\contexts\AuthContext.tsx`),{__esModule:l,$$typeof:d}=n;n.default;let c=n.AuthProvider;n.useAuth;let u=(0,i.createProxy)(String.raw`D:\whatsou\apps\web\lib\contexts\CartContext.tsx`),{__esModule:p,$$typeof:_}=u;u.default;let g=u.CartProvider;u.useCart;let m=(0,i.createProxy)(String.raw`D:\whatsou\apps\web\components\ui\toaster.tsx`),{__esModule:h,$$typeof:f}=m;m.default;let y=m.Toaster,b=(0,i.createProxy)(String.raw`D:\whatsou\apps\web\components\providers\CapacitorProvider.tsx`),{__esModule:v,$$typeof:w}=b;b.default;let S=b.CapacitorProvider,x=(0,i.createProxy)(String.raw`D:\whatsou\apps\web\components\providers\MetaPixelProvider.tsx`),{__esModule:P,$$typeof:k}=x;x.default;let A=x.MetaPixelProvider,N=(0,i.createProxy)(String.raw`D:\whatsou\packages\shared\src\i18n\LanguageContext.tsx`),{__esModule:C,$$typeof:E}=N;N.default;let T=N.LanguageProvider;N.useLanguage;let O={title:"WhatSou - WhatsApp Commerce Platform",description:"Create your WhatsApp store in 60 seconds. Photo -> Price -> Sell",viewport:{width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,viewportFit:"cover"},openGraph:{title:"WhatSou - WhatsApp Commerce Platform",description:"Create your WhatsApp store in 60 seconds. Photo -> Price -> Sell",type:"website"},twitter:{card:"summary_large_image",title:"WhatSou - WhatsApp Commerce Platform",description:"Create your WhatsApp store in 60 seconds. Photo -> Price -> Sell"}};function RootLayout({children:e}){return(0,o.jsxs)("html",{lang:"en",children:[(0,o.jsx)(s(),{id:"meta-pixel",strategy:"afterInteractive",dangerouslySetInnerHTML:{__html:`
            !function(f,b,e,v,n,t,s)
            {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
            if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
            n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t,s)}(window, document,'script',
            'https://connect.facebook.net/en_US/fbevents.js');
            fbq('init', '689235877602305');
            fbq('track', 'PageView');
          `}}),(0,o.jsxs)("body",{className:"font-sans",children:[(0,o.jsx)("noscript",{children:(0,o.jsx)("img",{height:"1",width:"1",style:{display:"none"},src:"https://www.facebook.com/tr?id=689235877602305&ev=PageView&noscript=1",alt:""})}),(0,o.jsx)(c,{children:(0,o.jsx)(g,{children:(0,o.jsxs)(T,{children:[(0,o.jsx)(S,{children:(0,o.jsx)(A,{children:e})}),(0,o.jsx)(y,{})]})})})]})]})}},27840:(e,t,r)=>{"use strict";r.d(t,{getSupabaseAdmin:()=>getSupabaseAdmin});var o=r(12713);function getSupabaseAdmin(){let e="https://bwezqrjwdrobztgeutji.supabase.co",t=process.env.SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ3ZXpxcmp3ZHJvYnp0Z2V1dGppIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxMzg0MDIsImV4cCI6MjA4MTcxNDQwMn0.nsiHXb7EW4KmZqlPy2tZ1-5RTLUsfOMcNa9Wq3xtPeQ";if(console.log("--- DEBUG AUTH ---"),console.log("URL:",e),console.log("Service Role Key Present:",!!process.env.SUPABASE_SERVICE_ROLE_KEY),console.log("Anon Key Present:",!0),console.log("Selected Key (first 10 chars):",t?.substring(0,10)),console.log("------------------"),e||console.error("Missing NEXT_PUBLIC_SUPABASE_URL"),t||console.error("Missing SUPABASE_SERVICE_ROLE_KEY and NEXT_PUBLIC_SUPABASE_ANON_KEY"),!e||!t)throw Error("Supabase configuration missing (URL or Key)");if(!t.startsWith("ey"))throw console.error('CRITICAL: SUPABASE_SERVICE_ROLE_KEY is not a valid JWT (does not start with "ey").'),console.error("Current value starts with:",t.substring(0,5)),Error('Invalid SUPABASE_SERVICE_ROLE_KEY format. It must be a JWT starting with "ey..." (like your Anon key). You likely copied the wrong key/id from the dashboard.');return(0,o.createClient)(e,t,{auth:{persistSession:!1,autoRefreshToken:!1}})}},69450:(e,t,r)=>{"use strict";async function sendNewUserAlert(e,t){let r=`
🔔 *New User Registered*

👤 Name: N/A
📱 Phone: ${e}
📅 Date: ${new Date(t).toLocaleString("en-US")}
    `.trim();try{let e=await fetch("https://api.telegram.org/bot8289064862:AAGtVYRSK5Osuv3oIldMYkD0gAZxk5RyVDI/sendMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:"1177042323",text:r,parse_mode:"Markdown"})});e.ok||console.error("Failed to send Telegram notification:",await e.text())}catch(e){console.error("Error sending Telegram notification:",e)}}r.d(t,{sendNewUserAlert:()=>sendNewUserAlert})},20001:()=>{}};
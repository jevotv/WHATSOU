(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{9213:function(e,t,r){"use strict";r.d(t,{Z:function(){return createLucideIcon}});var n=r(7653);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...e)=>e.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:o="",children:i,iconNode:c,...l},u)=>(0,n.createElement)("svg",{ref:u,...a,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:mergeClasses("lucide",o),...l},[...c.map(([e,t])=>(0,n.createElement)(e,t)),...Array.isArray(i)?i:[i]])),createLucideIcon=(e,t)=>{let r=(0,n.forwardRef)(({className:r,...a},o)=>(0,n.createElement)(s,{ref:o,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(e)}`,r),...a}));return r.displayName=`${e}`,r}},9197:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(9213);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,n.Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},9590:function(e,t,r){Promise.resolve().then(r.bind(r,4576))},4576:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return SignupPage}});var n=r(7573),a=r(7653),s=r(6803),o=r(2056),i=r.n(o),c=r(9197),l=r(6923),u=r(6811);function SignupPage(){let[e,t]=(0,a.useState)("form"),[r,o]=(0,a.useState)(""),[d,h]=(0,a.useState)(""),[f,p]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[x,y]=(0,a.useState)(""),[b,v]=(0,a.useState)(!1),[w,j]=(0,a.useState)(!0),{signUp:N}=(0,s.useAuth)(),{t:k,language:I,setLanguage:C,direction:_}=(0,l.Z)(),handleSendOtp=async e=>{if(e.preventDefault(),y(""),d!==f){y("ar"===I?"كلمات المرور غير متطابقة":"Passwords do not match");return}if(d.length<6){y("ar"===I?"كلمة المرور يجب أن تكون 6 أحرف على الأقل":"Password must be at least 6 characters");return}v(!0);try{let e=(0,u.yL)(r),n=await fetch("".concat("https://bwezqrjwdrobztgeutji.supabase.co","/functions/v1/whatsapp-auth"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ3ZXpxcmp3ZHJvYnp0Z2V1dGppIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxMzg0MDIsImV4cCI6MjA4MTcxNDQwMn0.nsiHXb7EW4KmZqlPy2tZ1-5RTLUsfOMcNa9Wq3xtPeQ")},body:JSON.stringify({action:"send",phone:e})}),a=await n.json();if(!n.ok)throw Error(a.error||"Failed to send OTP");t("otp")}catch(e){y(e.message||"Failed to send verification code")}finally{v(!1)}},handleVerifyAndSignup=async e=>{e.preventDefault(),y(""),v(!0);try{let e=(0,u.yL)(r),t=await fetch("".concat("https://bwezqrjwdrobztgeutji.supabase.co","/functions/v1/whatsapp-auth"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ3ZXpxcmp3ZHJvYnp0Z2V1dGppIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYxMzg0MDIsImV4cCI6MjA4MTcxNDQwMn0.nsiHXb7EW4KmZqlPy2tZ1-5RTLUsfOMcNa9Wq3xtPeQ")},body:JSON.stringify({action:"verify",phone:e,code:m,verify_only:!0})}),n=await t.json();if(!t.ok)throw Error(n.error||"Invalid code");await N(e,d)}catch(e){y(e.message||"Failed to verify")}finally{v(!1)}};return(0,n.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-[#f6f8f7] to-[#e8f5e9] px-4",dir:_,children:(0,n.jsxs)("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8 relative",children:[(0,n.jsx)("div",{className:"absolute top-4 right-4",children:(0,n.jsx)("button",{onClick:()=>C("en"===I?"ar":"en"),className:"p-2 rounded-full hover:bg-gray-100 transition",children:(0,n.jsx)(c.Z,{className:"w-5 h-5 text-gray-600"})})}),(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("div",{className:"mx-auto bg-[#008069] w-16 h-16 rounded-3xl flex items-center justify-center overflow-hidden mb-4",children:(0,n.jsx)("div",{className:"text-white font-bold text-2xl",children:"W"})}),(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:k("auth.register_title")||"Create Account"}),(0,n.jsx)("p",{className:"text-gray-600",children:"form"===e?k("auth.register_subtitle")||"Get started with your store":"".concat("ar"===I?"أدخل الرمز المرسل إلى":"Enter code sent to"," ").concat(r)})]}),(0,n.jsxs)("form",{onSubmit:"form"===e?handleSendOtp:handleVerifyAndSignup,className:"space-y-6",children:[x&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg",children:x}),"form"===e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:k("auth.phone_label")||"Phone Number"}),(0,n.jsx)("input",{type:"tel",value:r,onChange:e=>o(e.target.value),placeholder:"ar"===I?"01XXXXXXXXX":"Phone Number",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#008069] focus:border-transparent outline-none transition",required:!0,dir:"ltr"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:k("auth.password_label")||"Password"}),(0,n.jsx)("input",{type:"password",value:d,onChange:e=>h(e.target.value),placeholder:"********",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#008069] focus:border-transparent outline-none transition",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:k("auth.confirm_password_label")||"Confirm Password"}),(0,n.jsx)("input",{type:"password",value:f,onChange:e=>p(e.target.value),placeholder:"********",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#008069] focus:border-transparent outline-none transition",required:!0})]}),(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("input",{type:"checkbox",id:"privacy-agree",checked:w,onChange:e=>j(e.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-[#008069] focus:ring-[#008069]"}),(0,n.jsxs)("label",{htmlFor:"privacy-agree",className:"text-sm text-gray-600",children:[k("auth.agree_privacy")||"I agree to the"," ",(0,n.jsx)(i(),{href:"/privacy",target:"_blank",className:"text-[#008069] hover:underline",children:k("auth.privacy_policy")||"Privacy Policy"})]})]})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ar"===I?"رمز التحقق":"Verification Code"}),(0,n.jsx)("input",{type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"123456",maxLength:6,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#008069] focus:border-transparent outline-none transition text-center text-lg tracking-widest",required:!0,dir:"ltr"})]}),(0,n.jsx)("button",{type:"submit",disabled:b||"form"===e&&!w,className:"w-full py-3 px-4 bg-[#008069] hover:bg-[#006d5b] text-white font-bold rounded-lg transition disabled:opacity-50",children:b?"form"===e?"ar"===I?"جاري الإرسال...":"Sending Code...":"ar"===I?"جاري إنشاء الحساب...":"Creating Account...":"form"===e?k("auth.create_account")||"Create Account":"ar"===I?"تحقق وإنشاء حساب":"Verify & Signup"}),"otp"===e&&(0,n.jsx)("button",{type:"button",onClick:()=>t("form"),className:"w-full text-sm text-gray-500 hover:text-gray-700 mt-2",children:"ar"===I?"العودة للبيانات":"Back to Details"})]}),(0,n.jsx)("div",{className:"mt-6 text-center",children:(0,n.jsxs)("p",{className:"text-gray-600",children:[k("auth.has_account")||"Already have an account?"," ",(0,n.jsx)(i(),{href:"/login",className:"text-[#008069] font-medium hover:underline",children:k("auth.sign_in_link")||"Sign In"})]})})]})})}},6803:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var n=r(7573),a=r(7653),s=r(2859),o=r(8681);let i=(0,a.createContext)(void 0);function useAuth(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function AuthProvider(e){let{children:t}=e,[r,c]=(0,a.useState)(null),[l,u]=(0,a.useState)(!0),d=(0,s.useRouter)();(0,a.useEffect)(()=>{let checkSession=async()=>{if(!o.h.isAuthenticated()){u(!1);return}try{let e=await o.h.get("/api/auth/session");e.authenticated&&e.user?c(e.user):o.h.clearToken()}catch(e){console.error("Session check failed:",e),o.h.clearToken()}u(!1)};checkSession()},[]);let signIn=async(e,t)=>{try{let r=await o.h.post("/api/auth/login",{phone:e,password:t});if(r.error)return{error:r.error};return o.h.setToken(r.token),c(r.user),d.push("/dashboard"),{}}catch(e){return{error:e.message}}},signUp=async(e,t)=>{try{let r=await o.h.post("/api/auth/signup",{phone:e,password:t});if(r.error)return{error:r.error};return o.h.setToken(r.token),c(r.user),d.push("/onboarding"),{}}catch(e){return{error:e.message}}};return(0,n.jsx)(i.Provider,{value:{user:r,loading:l,signIn,signUp,signOut:()=>{o.h.clearToken(),c(null),d.push("/login")}},children:t})}},6811:function(e,t,r){"use strict";function standardizePhoneNumber(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"20",r=e.replace(/[^\d+]/g,"");return r.startsWith("+")?r:r.startsWith(t)?"+".concat(r):r.startsWith("0")?"+".concat(t).concat(r.substring(1)):"+".concat(t).concat(r)}r.d(t,{yL:function(){return standardizePhoneNumber}})},812:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return s}});let n=r(7675),a=n._(r(7653)),s=a.default.createContext(null)},6923:function(e,t,r){"use strict";r.d(t,{Z:function(){return n.useLanguage}});var n=r(7855)},8294:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(7653),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var n,s={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,n)&&!c.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:a,type:e,key:l,ref:u,props:s,_owner:i.current}}t.Fragment=s,t.jsx=q,t.jsxs=q},7573:function(e,t,r){"use strict";e.exports=r(8294)},2859:function(e,t,r){e.exports=r(7699)}},function(e){e.O(0,[56,612,293,53,744],function(){return e(e.s=9590)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{6468:function(e,t,r){Promise.resolve().then(r.bind(r,1709))},1709:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return LoginPage}});var n=r(7573),s=r(7653),o=r(6803),a=r(2056),i=r.n(a);function LoginPage(){let[e,t]=(0,s.useState)(""),[r,a]=(0,s.useState)(""),[u,c]=(0,s.useState)(""),[l,h]=(0,s.useState)(!1),{signIn:d}=(0,o.useAuth)(),handleSubmit=async t=>{t.preventDefault(),c(""),h(!0);let n=await d(e,r);n.error&&c(n.error),h(!1)};return(0,n.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-[#f6f8f7] to-[#e8f5e9] px-4",children:(0,n.jsxs)("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"مرحباً بك"}),(0,n.jsx)("p",{className:"text-gray-600",children:"سجل دخولك للوصول لمتجرك"})]}),(0,n.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[u&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg",children:u}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),(0,n.jsx)("input",{type:"tel",value:e,onChange:e=>t(e.target.value),placeholder:"01XXXXXXXXX",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#008069] focus:border-transparent outline-none transition",required:!0,dir:"ltr"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كلمة المرور"}),(0,n.jsx)("input",{type:"password",value:r,onChange:e=>a(e.target.value),placeholder:"********",className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#008069] focus:border-transparent outline-none transition",required:!0})]}),(0,n.jsx)("button",{type:"submit",disabled:l,className:"w-full py-3 px-4 bg-[#008069] hover:bg-[#006d5b] text-white font-bold rounded-lg transition disabled:opacity-50",children:l?"جاري التسجيل...":"تسجيل الدخول"})]}),(0,n.jsx)("div",{className:"mt-6 text-center",children:(0,n.jsxs)("p",{className:"text-gray-600",children:["ليس لديك حساب؟"," ",(0,n.jsx)(i(),{href:"/signup",className:"text-[#008069] font-medium hover:underline",children:"إنشاء حساب جديد"})]})})]})})}},8681:function(e,t,r){"use strict";r.d(t,{h:function(){return n}});let n=new class{setToken(e){this.token=e,localStorage.setItem("auth_token",e)}getToken(){return this.token||(this.token=localStorage.getItem("auth_token")),this.token}clearToken(){this.token=null,localStorage.removeItem("auth_token")}isAuthenticated(){return!!this.getToken()}async fetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getToken(),n="".concat("https://whatsou-git-feature-monorepo-jevotv-3403s-projects.vercel.app").concat(e);console.log("API Request: ".concat(t.method||"GET"," ").concat(n));try{let e=await fetch(n,{...t,headers:{"Content-Type":"application/json",...r?{Authorization:"Bearer ".concat(r)}:{},...t.headers}}),s=await e.json();if(!e.ok)throw console.error("API Error Response: ".concat(e.status),s),401===e.status&&this.clearToken(),Error(s.error||"API Error: ".concat(e.status));return s}catch(e){throw console.error("API Fetch Error Details:",e),console.error("Request URL:",n),e}}get(e){return this.fetch(e,{method:"GET"})}post(e,t){return this.fetch(e,{method:"POST",body:t?JSON.stringify(t):void 0})}put(e,t){return this.fetch(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}delete(e){return this.fetch(e,{method:"DELETE"})}constructor(){this.token=null}}},6803:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var n=r(7573),s=r(7653),o=r(2859),a=r(8681);let i=(0,s.createContext)(void 0);function useAuth(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function AuthProvider(e){let{children:t}=e,[r,u]=(0,s.useState)(null),[c,l]=(0,s.useState)(!0),h=(0,o.useRouter)();(0,s.useEffect)(()=>{let checkSession=async()=>{if(!a.h.isAuthenticated()){l(!1);return}try{let e=await a.h.get("/api/auth/session");e.authenticated&&e.user?u(e.user):a.h.clearToken()}catch(e){console.error("Session check failed:",e),a.h.clearToken()}l(!1)};checkSession()},[]);let signIn=async(e,t)=>{try{let r=await a.h.post("/api/auth/login",{phone:e,password:t});if(r.error)return{error:r.error};return a.h.setToken(r.token),u(r.user),h.push("/dashboard"),{}}catch(e){return{error:e.message}}},signUp=async(e,t)=>{try{let r=await a.h.post("/api/auth/signup",{phone:e,password:t});if(r.error)return{error:r.error};return a.h.setToken(r.token),u(r.user),h.push("/onboarding"),{}}catch(e){return{error:e.message}}};return(0,n.jsx)(i.Provider,{value:{user:r,loading:c,signIn,signUp,signOut:()=>{a.h.clearToken(),u(null),h.push("/login")}},children:t})}}},function(e){e.O(0,[506,293,53,744],function(){return e(e.s=6468)}),_N_E=e.O()}]);
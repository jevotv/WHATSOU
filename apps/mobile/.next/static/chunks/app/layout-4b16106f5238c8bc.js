(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{450:function(e,t,r){Promise.resolve().then(r.t.bind(r,3828,23)),Promise.resolve().then(r.bind(r,6803))},8681:function(e,t,r){"use strict";r.d(t,{h:function(){return o}});let o=new class{setToken(e){this.token=e,localStorage.setItem("auth_token",e)}getToken(){return this.token||(this.token=localStorage.getItem("auth_token")),this.token}clearToken(){this.token=null,localStorage.removeItem("auth_token")}isAuthenticated(){return!!this.getToken()}async fetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getToken(),o="".concat("https://whatsou-git-feature-monorepo-jevotv-3403s-projects.vercel.app").concat(e);console.log("API Request: ".concat(t.method||"GET"," ").concat(o));try{let e=await fetch(o,{...t,headers:{"Content-Type":"application/json",...r?{Authorization:"Bearer ".concat(r)}:{},...t.headers}}),n=await e.json();if(!e.ok)throw console.error("API Error Response: ".concat(e.status),n),401===e.status&&this.clearToken(),Error(n.error||"API Error: ".concat(e.status));return n}catch(e){throw console.error("API Fetch Error Details:",e),console.error("Request URL:",o),e}}get(e){return this.fetch(e,{method:"GET"})}post(e,t){return this.fetch(e,{method:"POST",body:t?JSON.stringify(t):void 0})}put(e,t){return this.fetch(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}delete(e){return this.fetch(e,{method:"DELETE"})}constructor(){this.token=null}}},6803:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var o=r(7573),n=r(7653),s=r(2859),u=r(8681);let i=(0,n.createContext)(void 0);function useAuth(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function AuthProvider(e){let{children:t}=e,[r,c]=(0,n.useState)(null),[a,h]=(0,n.useState)(!0),l=(0,s.useRouter)();(0,n.useEffect)(()=>{let checkSession=async()=>{if(!u.h.isAuthenticated()){h(!1);return}try{let e=await u.h.get("/api/auth/session");e.authenticated&&e.user?c(e.user):u.h.clearToken()}catch(e){console.error("Session check failed:",e),u.h.clearToken()}h(!1)};checkSession()},[]);let signIn=async(e,t)=>{try{let r=await u.h.post("/api/auth/login",{phone:e,password:t});if(r.error)return{error:r.error};return u.h.setToken(r.token),c(r.user),l.push("/dashboard"),{}}catch(e){return{error:e.message}}},signUp=async(e,t)=>{try{let r=await u.h.post("/api/auth/signup",{phone:e,password:t});if(r.error)return{error:r.error};return u.h.setToken(r.token),c(r.user),l.push("/onboarding"),{}}catch(e){return{error:e.message}}};return(0,o.jsx)(i.Provider,{value:{user:r,loading:a,signIn,signUp,signOut:()=>{u.h.clearToken(),c(null),l.push("/login")}},children:t})}},3828:function(){},8294:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o=r(7653),n=Symbol.for("react.element"),s=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),u=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var o,c={},a=null,h=null;for(o in void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(h=t.ref),t)s.call(t,o)&&!i.hasOwnProperty(o)&&(c[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===c[o]&&(c[o]=t[o]);return{$$typeof:n,type:e,key:a,ref:h,props:c,_owner:u.current}}t.jsx=q,t.jsxs=q},7573:function(e,t,r){"use strict";e.exports=r(8294)},2859:function(e,t,r){e.exports=r(7699)}},function(e){e.O(0,[293,53,744],function(){return e(e.s=450)}),_N_E=e.O()}]);
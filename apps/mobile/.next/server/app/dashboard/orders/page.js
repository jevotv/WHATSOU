(()=>{var e={};e.id=857,e.ids=[857],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},57147:e=>{"use strict";e.exports=require("fs")},12781:e=>{"use strict";e.exports=require("stream")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},61329:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>d.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o});var t=r(66965),a=r(74902),l=r(36408),d=r.n(l),i=r(14346),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);r.d(s,n);let o=["",{children:["dashboard",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,71081)),"D:\\whatsou\\apps\\mobile\\app\\dashboard\\orders\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,97913)),"D:\\whatsou\\apps\\mobile\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,47806)),"D:\\whatsou\\apps\\mobile\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,31227)),"D:\\whatsou\\apps\\mobile\\app\\not-found.tsx"]}],c=["D:\\whatsou\\apps\\mobile\\app\\dashboard\\orders\\page.tsx"],x="/dashboard/orders/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/orders/page",pathname:"/dashboard/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},62667:(e,s,r)=>{Promise.resolve().then(r.bind(r,21087))},21087:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>OrdersPage});var t=r(84196),a=r(78726),l=r(65714),d=r(78611),i=r(34105),n=r(24850),o=r(56617),c=r(86442),x=r(85905),p=r(51356),m=r(5460),h=r(7930),u=r(50198),y=r(12753),g=r(8410),b=r(65884),j=r(13343),_=r(78019),f=r(3486),v=r(80019),N=r(11986),w=r(88737),Z=r(97487),P=r(57700),D=r(24288),q=r.n(D),k=r(69211);function OrdersPage(){let[e,s]=(0,a.useState)([]),[r,D]=(0,a.useState)(!0),[C,S]=(0,a.useState)(null),[E,A]=(0,a.useState)(""),[M,O]=(0,a.useState)("all"),[Q,F]=(0,a.useState)("all"),[$,R]=(0,a.useState)(!1),{t:G,direction:L,language:B}=(0,Z.Z)(),{subscription:I,loading:V}=(0,P.m)(),z=I?.isReadOnly??!1,{user:T}=(0,l.useAuth)(),U=(0,a.useCallback)(async()=>{if(T)try{let e=await k.h.get("/api/dashboard/orders");if(e.error){console.error("Error fetching orders:",e.error),D(!1);return}e.storeSettings&&R(!0===e.storeSettings.allow_delivery&&!0===e.storeSettings.allow_pickup),s(e.orders||[])}catch(e){console.error("Unexpected error:",e)}finally{D(!1)}},[T]);(0,a.useEffect)(()=>{U()},[U]);let toggleExpand=e=>{S(C===e?null:e)};return r||V?t.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:t.jsx(d.Z,{className:"w-8 h-8 animate-spin text-gray-400"})}):z?t.jsx("div",{className:"max-w-md mx-auto px-4 py-16 text-center",children:(0,t.jsxs)("div",{className:"bg-red-100 border-2 border-red-500 rounded-2xl p-8",children:[t.jsx(i.Z,{className:"w-16 h-16 mx-auto text-red-600 mb-4"}),t.jsx("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"ar"===B?"وضع القراءة فقط":"Read-Only Mode"}),t.jsx("p",{className:"text-red-600 mb-6",children:"ar"===B?"اشتراكك منتهي. جدد للوصول لبيانات الطلبات.":"Your subscription has expired. Renew to access order data."}),t.jsx(q(),{href:"/dashboard/subscription",className:"inline-block bg-red-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-red-700",children:"ar"===B?"جدد الآن":"Renew Now"})]})}):(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8 pb-32",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold",children:G("dashboard.nav_orders")||"Orders"}),t.jsx("span",{className:"bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-sm font-medium",children:e.length})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[t.jsx(n.Z,{className:`absolute ${"rtl"===L?"right-3":"left-3"} top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4`}),t.jsx(y.I,{placeholder:G("dashboard.search_orders"),value:E,onChange:e=>A(e.target.value),className:`${"rtl"===L?"pr-10":"pl-10"} rounded-xl bg-white`})]}),(0,t.jsxs)(g.Ph,{value:M,onValueChange:O,children:[(0,t.jsxs)(g.i4,{className:"w-full sm:w-[180px] rounded-xl bg-white",children:[t.jsx(o.Z,{className:"w-4 h-4 mr-2 text-gray-400"}),t.jsx(g.ki,{placeholder:"Filter by date"})]}),(0,t.jsxs)(g.Bw,{children:[t.jsx(g.Ql,{value:"all",children:G("dashboard.filter_all")}),t.jsx(g.Ql,{value:"today",children:G("dashboard.filter_today")}),t.jsx(g.Ql,{value:"yesterday",children:G("dashboard.filter_yesterday")}),t.jsx(g.Ql,{value:"last_7_days",children:G("dashboard.filter_last_7_days")}),t.jsx(g.Ql,{value:"last_30_days",children:G("dashboard.filter_last_30_days")})]})]}),$&&(0,t.jsxs)(g.Ph,{value:Q,onValueChange:F,children:[t.jsx(g.i4,{className:"w-full sm:w-[150px] rounded-xl bg-white",children:t.jsx(g.ki,{placeholder:G("dashboard.filter_delivery_type")})}),(0,t.jsxs)(g.Bw,{children:[t.jsx(g.Ql,{value:"all",children:G("dashboard.filter_all_types")}),t.jsx(g.Ql,{value:"delivery",children:G("dashboard.filter_delivery")}),t.jsx(g.Ql,{value:"pickup",children:G("dashboard.filter_pickup")})]})]})]}),0===e.filter(e=>{let s=E.toLowerCase(),r=e.customer_name.toLowerCase().includes(s)||e.customer_phone.includes(s);if(!r)return!1;let t=(0,w.Z)(e.created_at);return"today"===M?(0,j.Z)(t):"yesterday"===M?(0,_.Z)(t):"last_7_days"===M?(0,v.Z)(t,(0,f.Z)((0,N.Z)(new Date),7)):"last_30_days"!==M||(0,v.Z)(t,(0,f.Z)((0,N.Z)(new Date),30))}).filter(e=>"all"===Q||e.delivery_type===Q).length?(0,t.jsxs)("div",{className:"text-center py-12 bg-white rounded-2xl border border-dashed border-gray-200",children:[t.jsx(c.Z,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.jsx("p",{className:"text-gray-500",children:G("dashboard.no_orders")||"No orders found"})]}):t.jsx("div",{className:"space-y-4",children:e.filter(e=>{let s=E.toLowerCase(),r=e.customer_name.toLowerCase().includes(s)||e.customer_phone.includes(s);if(!r)return!1;let t=(0,w.Z)(e.created_at);return"today"===M?(0,j.Z)(t):"yesterday"===M?(0,_.Z)(t):"last_7_days"===M?(0,v.Z)(t,(0,f.Z)((0,N.Z)(new Date),7)):"last_30_days"!==M||(0,v.Z)(t,(0,f.Z)((0,N.Z)(new Date),30))}).filter(e=>"all"===Q||e.delivery_type===Q).map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 flex flex-col sm:flex-row sm:items-center justify-between gap-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>toggleExpand(e.id),children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["pickup"===e.delivery_type?t.jsx("span",{title:G("dashboard.filter_pickup"),className:"text-lg",children:"\uD83C\uDFEA"}):t.jsx("span",{title:G("dashboard.filter_delivery"),className:"text-lg",children:"\uD83C\uDFE0"}),t.jsx("span",{className:"font-bold text-lg",children:e.customer_name})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[t.jsx(x.Z,{className:"w-3 h-3"})," ",e.customer_phone]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[t.jsx(p.Z,{className:"w-3 h-3"})," ",(0,b.ZP)(new Date(e.created_at),"MMM d, yyyy h:mm a")]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between sm:justify-end gap-4 min-w-[120px]",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-bold text-lg",children:[G("common.currency")," ",Number(e.total_price).toFixed(2)]}),void 0!==e.shipping_cost&&e.shipping_cost>0&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["(Inc. ",G("common.currency")," ",Number(e.shipping_cost).toFixed(2)," Shipping)"]})]}),C===e.id?t.jsx(m.Z,{className:"w-5 h-5 text-gray-400"}):t.jsx(h.Z,{className:"w-5 h-5 text-gray-400"})]})]}),C===e.id&&(0,t.jsxs)("div",{className:"p-4 bg-gray-50 border-t border-gray-100 space-y-4",children:[(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("h4",{className:"font-medium mb-2 text-gray-700 flex items-center gap-2",children:[t.jsx(u.Z,{className:"w-4 h-4"})," ",G("customers.delivery_address")]}),(0,t.jsxs)("div",{className:"text-gray-600 pl-6 space-y-1",children:[t.jsx("p",{children:e.customer_address}),(e.city||e.district)&&t.jsx("p",{className:"text-sm text-gray-400",children:[e.district,e.city].filter(Boolean).join(", ")})]})]}),e.notes&&(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("h4",{className:"font-medium mb-2 text-gray-700 flex items-center gap-2",children:["\uD83D\uDCDD ",G("common.notes")||"Notes"]}),t.jsx("p",{className:"text-gray-600 pl-6",children:e.notes})]}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("h4",{className:"font-medium mb-2 text-gray-700 flex items-center gap-2",children:[t.jsx(c.Z,{className:"w-4 h-4"})," ",G("customers.order_items")]}),t.jsx("div",{className:"pl-6 space-y-2",children:Array.isArray(e.order_items)&&e.order_items.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center text-gray-600 bg-white p-2 rounded-lg border border-gray-100",children:[(0,t.jsxs)("span",{children:[(0,t.jsxs)("span",{className:"font-semibold text-black",children:[e.quantity,"x"]})," ",e.product_name,e.selected_options&&Object.keys(e.selected_options).length>0&&(0,t.jsxs)("span",{className:"text-gray-400 ml-1 text-xs",children:["(",Object.entries(e.selected_options).map(([e,s])=>`${e}:${s}`).join(", "),")"]})]}),(0,t.jsxs)("span",{children:[G("common.currency")," ",(e.price*e.quantity).toFixed(2)]})]},s))})]})]})]},e.id))})]})}},71081:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>d,__esModule:()=>l,default:()=>n});var t=r(64074);let a=(0,t.createProxy)(String.raw`D:\whatsou\apps\mobile\app\dashboard\orders\page.tsx`),{__esModule:l,$$typeof:d}=a,i=a.default,n=i}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[64,583,235,308,517,890,533,967,141,364,436],()=>__webpack_exec__(61329));module.exports=r})();
(()=>{var e={};e.id=461,e.ids=[461],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},89050:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>g,pages:()=>c,routeModule:()=>p,tree:()=>d});var t=r(66965),s=r(74902),n=r(36408),o=r.n(n),i=r(14346),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(a,l);let d=["",{children:["onboarding",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,56859)),"D:\\whatsou\\apps\\mobile\\app\\onboarding\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,47806)),"D:\\whatsou\\apps\\mobile\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,31227)),"D:\\whatsou\\apps\\mobile\\app\\not-found.tsx"]}],c=["D:\\whatsou\\apps\\mobile\\app\\onboarding\\page.tsx"],g="/onboarding/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/onboarding/page",pathname:"/onboarding",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},61676:(e,a,r)=>{Promise.resolve().then(r.bind(r,15414))},15414:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>OnboardingPage});var t=r(84196),s=r(78726),n=r(65714),o=r(74555),i=r(12428),l=r(69211),d=r(2420),c=r(12753),g=r(91586),u=r(62364),p=r(32583),x=r(38249),m=r(58406),h=r(72023);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let b=(0,h.Z)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var f=r(53374),v=r(6006),j=r(85905),_=r(29930),N=r(64690),y=r(25413),w=r(19886),k=r(19328),S=r.n(k),C=r(82182),P=r(97487),q=r(15246),I=r(52065);function OnboardingPage(){let[e,a]=(0,s.useState)(1),[h,k]=(0,s.useState)(!1),[$,L]=(0,s.useState)(!0),{user:E,loading:Z}=(0,n.useAuth)(),A=(0,o.useRouter)(),{toast:D}=(0,y.pm)(),{t:z,language:O,setLanguage:G,direction:M}=(0,P.Z)(),[R,T]=(0,s.useState)(""),[U,F]=(0,s.useState)(""),[B,H]=(0,s.useState)(!1),[V,W]=(0,s.useState)(""),[X,Y]=(0,s.useState)(!0),[J,K]=(0,s.useState)(!1),[Q,ee]=(0,s.useState)("en"),[ea,er]=(0,s.useState)(null),[et,es]=(0,s.useState)(""),[en,eo]=(0,s.useState)(""),[ei,el]=(0,s.useState)(""),[ed,ec]=(0,s.useState)(""),[eg,eu]=(0,s.useState)(""),[ep,ex]=(0,s.useState)(""),[em,eh]=(0,s.useState)("");(0,s.useEffect)(()=>{let checkExistingStore=async()=>{if(Z)return;if(!E){A.push("/login");return}let{data:e}=await i.O.from("stores").select("id").eq("user_id",E.id).maybeSingle();e?A.push("/dashboard"):L(!1)};checkExistingStore()},[E,A,Z]);let handleDefaultLanguageChange=e=>{ee(e),("ar"===e||"en"===e)&&G(e)},generateSlug=e=>(0,q.l)(e),handleGetLocation=async()=>{if(I.Capacitor.isNativePlatform()){try{D({title:z("onboarding.locating"),description:z("onboarding.getting_location")});let{Geolocation:e}=await r.e(640).then(r.bind(r,59640)),a=await e.checkPermissions();if("granted"!==a.location){let a=await e.requestPermissions();if("granted"!==a.location)throw Error("Permission denied")}let t=await e.getCurrentPosition(),{latitude:s,longitude:n}=t.coords,o=`https://www.google.com/maps?q=${s},${n}`;eh(o),D({title:z("onboarding.location_found"),description:z("onboarding.location_set")})}catch(e){console.error("Geolocation error:",e),D({title:z("common.error"),description:e.message||z("onboarding.location_error"),variant:"destructive"})}return}if(!navigator.geolocation){D({title:z("common.error"),description:z("onboarding.geolocation_not_supported"),variant:"destructive"});return}D({title:z("onboarding.locating"),description:z("onboarding.getting_location")}),navigator.geolocation.getCurrentPosition(e=>{let{latitude:a,longitude:r}=e.coords,t=`https://www.google.com/maps?q=${a},${r}`;eh(t),D({title:z("onboarding.location_found"),description:z("onboarding.location_set")})},e=>{console.error("Geolocation error:",e);let a=z("onboarding.location_error");e.code===e.PERMISSION_DENIED?a=z("onboarding.location_permission_denied"):e.code===e.POSITION_UNAVAILABLE?a=z("onboarding.location_unavailable"):e.code===e.TIMEOUT&&(a=z("onboarding.location_timeout")),D({title:z("common.error"),description:a,variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},uploadLogo=async()=>{if(!ea)return null;try{let e=new FormData;e.append("file",ea),e.append("folder","logos");let a=I.Capacitor.isNativePlatform()?"https://whatsou.com":"",r=await fetch(`${a}/api/upload`,{method:"POST",body:e,headers:{...l.h.getToken()?{Authorization:`Bearer ${l.h.getToken()}`}:{}}}),t=await r.json();if(!r.ok)throw Error(t.error||"Upload failed");return t.url}catch(e){return console.error("Logo upload error:",e),D({title:z("onboarding.logo_upload_warning"),description:z("onboarding.logo_upload_failed"),variant:"destructive"}),null}},handleSubmit=async()=>{if(E){k(!0);try{let e=U||generateSlug(R),{data:r}=await i.O.from("stores").select("id").eq("slug",e).maybeSingle();if(r){D({title:z("onboarding.store_name_taken"),description:z("onboarding.store_name_taken_desc"),variant:"destructive"}),k(!1),a(1);return}let t=await uploadLogo(),s={name:R,slug:e,description:V,whatsapp_number:(0,w.yL)(E.phone),default_language:Q,email:en,logo_url:t,facebook_url:ei,instagram_url:ed,twitter_url:eg,tiktok_url:ep,location_url:em,allow_delivery:X,allow_pickup:J},n=await l.h.post("/api/dashboard/store",s);if(n.error)throw Error(n.error);D({title:z("onboarding.store_created"),description:z("onboarding.welcome_message")}),A.push("/dashboard/subscription")}catch(e){D({title:z("common.error"),description:e.message,variant:"destructive"}),k(!1)}}};return $?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):(0,t.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 to-teal-50 p-4",dir:M,children:[t.jsx(d.z,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 bg-white/50 backdrop-blur-sm rounded-full hover:bg-white/80 transition-all z-10",onClick:()=>{G("en"===O?"ar":"en")},title:"Switch Language",children:t.jsx(p.Z,{className:"w-5 h-5 text-green-700"})}),(0,t.jsxs)(u.Zb,{className:"w-full max-w-2xl rounded-3xl shadow-xl overflow-hidden",children:[t.jsx("div",{className:"bg-green-600 p-2",children:(0,t.jsxs)("div",{className:`flex justify-center gap-2 ${"rtl"===M?"flex-row-reverse":""}`,children:[t.jsx("div",{className:`h-2 w-1/2 rounded-full transition-all ${e>=1?"bg-white":"bg-green-800/30"}`}),t.jsx("div",{className:`h-2 w-1/2 rounded-full transition-all ${e>=2?"bg-white":"bg-green-800/30"}`})]})}),(0,t.jsxs)(u.Ol,{className:"text-center space-y-4 pt-8",children:[t.jsx("div",{className:"mx-auto bg-green-100 w-16 h-16 rounded-3xl flex items-center justify-center mb-2",children:1===e?t.jsx(S(),{src:"/logo.png",alt:"WhatSou Logo",width:48,height:48,className:"w-10 h-10 object-contain"}):t.jsx(x.Z,{className:"w-8 h-8 text-green-600"})}),t.jsx(u.ll,{className:"text-3xl font-bold",children:1===e?z("onboarding.step1_title"):z("onboarding.step2_title")}),t.jsx(u.SZ,{className:"text-base",children:1===e?z("onboarding.step1_desc"):z("onboarding.step2_desc")})]}),t.jsx(u.aY,{className:"p-8",children:1===e?(0,t.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-right-8 fade-in-0 duration-300",children:[(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C._,{children:[z("onboarding.store_name")," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(c.I,{placeholder:z("onboarding.store_name"),value:R,onChange:e=>T(e.target.value),className:"rounded-xl h-12"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[t.jsx("p",{className:"text-xs text-muted-foreground",dir:"ltr",children:z("onboarding.store_url").replace("{slug}","")}),B?(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-1 max-w-[200px]",children:[t.jsx(c.I,{value:U,onChange:e=>F((0,q.l)(e.target.value)),className:"h-7 text-xs px-2 rounded-md",autoFocus:!0,placeholder:"my-store"}),t.jsx("button",{onClick:()=>H(!1),className:"p-1 hover:bg-gray-100 rounded-full text-green-600",children:t.jsx(m.Z,{className:"w-4 h-4"})})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2 group",children:[t.jsx("span",{className:"font-medium text-xs text-green-700 bg-green-50 px-2 py-0.5 rounded dir-ltr",children:U||generateSlug(R)||"store-name"}),t.jsx("button",{onClick:()=>{U||F(generateSlug(R)),H(!0)},className:"p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-gray-100 rounded-full text-gray-500",title:"Edit URL",children:t.jsx(b,{className:"w-3 h-3"})})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(C._,{children:z("onboarding.default_language")}),(0,t.jsxs)("div",{className:"flex gap-4 p-3 border rounded-xl bg-gray-50/50",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"language",value:"en",checked:"en"===Q,onChange:e=>handleDefaultLanguageChange(e.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-600"}),t.jsx("span",{children:z("onboarding.english")})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"language",value:"ar",checked:"ar"===Q,onChange:e=>handleDefaultLanguageChange(e.target.value),className:"w-4 h-4 text-green-600 focus:ring-green-600"}),t.jsx("span",{children:z("onboarding.arabic")})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C._,{children:[z("onboarding.description")," ",t.jsx("span",{className:"text-xs text-gray-400",children:z("onboarding.description_optional")})]}),t.jsx(g.g,{placeholder:z("onboarding.description_placeholder"),value:V,onChange:e=>W(e.target.value),className:"rounded-xl resize-none",rows:3})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(C._,{children:[z("settings.delivery_options")," ",t.jsx("span",{className:"text-red-500",children:"*"})]}),(0,t.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,t.jsxs)("label",{className:`flex items-center gap-3 p-4 border-2 rounded-xl cursor-pointer transition-all ${X?"border-green-500 bg-green-50":"border-gray-200 bg-gray-50/50 hover:border-gray-300"}`,children:[t.jsx("input",{type:"checkbox",checked:X,onChange:e=>Y(e.target.checked),className:"w-5 h-5 text-green-600 focus:ring-green-600 rounded"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(f.Z,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-medium",children:z("settings.allow_delivery")})]})]}),(0,t.jsxs)("label",{className:`flex items-center gap-3 p-4 border-2 rounded-xl cursor-pointer transition-all ${J?"border-green-500 bg-green-50":"border-gray-200 bg-gray-50/50 hover:border-gray-300"}`,children:[t.jsx("input",{type:"checkbox",checked:J,onChange:e=>K(e.target.checked),className:"w-5 h-5 text-green-600 focus:ring-green-600 rounded"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(v.Z,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{className:"font-medium",children:z("settings.allow_pickup")})]})]})]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:z("onboarding.delivery_options_hint")})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(C._,{children:z("onboarding.whatsapp_number")}),(0,t.jsxs)("div",{className:"relative",children:[t.jsx(c.I,{value:E?.phone||"",disabled:!0,className:`rounded-xl h-12 bg-gray-50 ${"rtl"===M?"pr-10":"pl-10"}`}),t.jsx(j.Z,{className:`w-4 h-4 absolute top-4 text-gray-400 ${"rtl"===M?"right-3":"left-3"}`}),(0,t.jsxs)("div",{className:`absolute top-3 bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full flex items-center gap-1 ${"rtl"===M?"left-3":"right-3"}`,children:[t.jsx(m.Z,{className:"w-3 h-3"})," ",z("onboarding.verified")]})]}),t.jsx("p",{className:"text-xs text-muted-foreground",children:z("onboarding.linked_account")})]}),t.jsx(d.z,{onClick:()=>{if(!R.trim()){D({title:z("onboarding.required_field"),description:z("onboarding.enter_store_name"),variant:"destructive"});return}if(!X&&!J){D({title:z("onboarding.required_field"),description:z("settings.delivery_required_error"),variant:"destructive"});return}a(2)},className:"w-full h-12 rounded-xl bg-green-600 hover:bg-green-700 text-base font-semibold mt-4",children:z("onboarding.next_step")})]}):(0,t.jsxs)("div",{className:"space-y-6 animate-in slide-in-from-right-8 fade-in-0 duration-300",children:[(0,t.jsxs)("label",{className:"flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-200 rounded-2xl bg-gray-50/50 hover:bg-gray-100 transition-all cursor-pointer group",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:e=>{let a=e.target.files?.[0];if(a){er(a);let e=new FileReader;e.onloadend=()=>{es(e.result)},e.readAsDataURL(a)}},className:"hidden"}),(0,t.jsxs)("div",{className:"relative w-24 h-24 mb-4",children:[et?t.jsx(S(),{src:et,alt:"Logo preview",fill:!0,className:"object-cover rounded-full border-4 border-white shadow-md"}):t.jsx("div",{className:"w-full h-full rounded-full bg-white flex items-center justify-center border-2 border-green-100 shadow-sm group-hover:border-green-200 transition-colors",children:t.jsx(_.Z,{className:"w-8 h-8 text-green-600 opacity-50 group-hover:opacity-100 transition-opacity"})}),t.jsx("div",{className:`absolute bottom-0 p-1.5 bg-green-600 rounded-full text-white shadow-lg group-hover:bg-green-700 transition-colors ${"rtl"===M?"left-0":"right-0"}`,children:t.jsx(_.Z,{className:"w-4 h-4"})})]}),t.jsx("p",{className:"text-sm font-medium text-gray-600 group-hover:text-green-700 transition-colors",children:z("onboarding.upload_logo")}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:z("onboarding.logo_recommended")})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(C._,{children:z("onboarding.support_email")}),t.jsx(c.I,{type:"email",placeholder:z("onboarding.support_email_placeholder"),value:en,onChange:e=>eo(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(C._,{className:"text-xs text-gray-500 uppercase font-semibold",children:z("onboarding.facebook")}),t.jsx(c.I,{placeholder:"facebook.com/...",value:ei,onChange:e=>el(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(C._,{className:"text-xs text-gray-500 uppercase font-semibold",children:z("onboarding.instagram")}),t.jsx(c.I,{placeholder:"instagram.com/...",value:ed,onChange:e=>ec(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(C._,{className:"text-xs text-gray-500 uppercase font-semibold",children:z("onboarding.twitter")}),t.jsx(c.I,{placeholder:"twitter.com/...",value:eg,onChange:e=>eu(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(C._,{className:"text-xs text-gray-500 uppercase font-semibold",children:z("onboarding.tiktok")}),t.jsx(c.I,{placeholder:"tiktok.com/@...",value:ep,onChange:e=>ex(e.target.value),className:"rounded-xl"})]}),(0,t.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[t.jsx(C._,{className:"text-xs text-gray-500 uppercase font-semibold",children:z("onboarding.location")}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(c.I,{placeholder:"https://maps.google.com/...",value:em,onChange:e=>eh(e.target.value),className:"rounded-xl"}),t.jsx(d.z,{type:"button",variant:"outline",onClick:handleGetLocation,className:"rounded-xl shrink-0",title:z("onboarding.get_current_location"),children:t.jsx(v.Z,{className:"w-4 h-4"})})]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[t.jsx(d.z,{variant:"outline",onClick:()=>a(1),className:"h-12 w-12 rounded-xl border-gray-200 p-0 shrink-0",children:t.jsx(N.Z,{className:`w-5 h-5 ${"rtl"===M?"rotate-180":""}`})}),t.jsx(d.z,{onClick:handleSubmit,disabled:h,className:"flex-1 h-12 rounded-xl bg-green-600 hover:bg-green-700 text-base font-semibold",children:h?z("onboarding.creating_store"):z("onboarding.launch_store")})]})]})})]})]})}},12753:(e,a,r)=>{"use strict";r.d(a,{I:()=>o});var t=r(84196),s=r(78726),n=r(42135);let o=s.forwardRef(({className:e,type:a,...r},s)=>t.jsx("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));o.displayName="Input"},56859:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$typeof:()=>o,__esModule:()=>n,default:()=>l});var t=r(64074);let s=(0,t.createProxy)(String.raw`D:\whatsou\apps\mobile\app\onboarding\page.tsx`),{__esModule:n,$$typeof:o}=s,i=s.default,l=i}};var a=require("../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),r=a.X(0,[64,583,235,767,239,967,141,886,669,230],()=>__webpack_exec__(89050));module.exports=r})();
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[633],{9213:function(e,t,a){"use strict";a.d(t,{Z:function(){return createLucideIcon}});var r=a(7653);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...e)=>e.filter((e,t,a)=>!!e&&a.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:l="",children:i,iconNode:o,...c},d)=>(0,r.createElement)("svg",{ref:d,...s,width:t,height:t,stroke:e,strokeWidth:n?24*Number(a)/Number(t):a,className:mergeClasses("lucide",l),...c},[...o.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(i)?i:[i]])),createLucideIcon=(e,t)=>{let a=(0,r.forwardRef)(({className:a,...s},l)=>(0,r.createElement)(n,{ref:l,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(e)}`,a),...s}));return a.displayName=`${e}`,a}},852:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(9213);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r.Z)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},8793:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(9213);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r.Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])},1452:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(9213);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},246:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(9213);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r.Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},265:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(9213);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r.Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3836:function(e,t,a){Promise.resolve().then(a.bind(a,8213))},8213:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return SubscriptionPage}});var r=a(7573),s=a(7653),n=a(2859),l=a(6923),i=a(4301),o=a(8681),c=a(9213);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,c.Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var u=a(265);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,c.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),h=(0,c.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var x=a(852),y=a(1452);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,c.Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var g=a(246);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,c.Z)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]),b=(0,c.Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var v=a(8793);let w={active:{color:"bg-green-500",textColor:"text-green-600",bgColor:"bg-green-50",icon:d,labelAr:"نشط",labelEn:"Active"},grace:{color:"bg-yellow-500",textColor:"text-yellow-600",bgColor:"bg-yellow-50",icon:u.Z,labelAr:"فترة سماح",labelEn:"Grace Period"},expired:{color:"bg-red-500",textColor:"text-red-600",bgColor:"bg-red-50",icon:m,labelAr:"منتهي",labelEn:"Expired"},inactive:{color:"bg-gray-400",textColor:"text-gray-600",bgColor:"bg-gray-50",icon:h,labelAr:"غير نشط",labelEn:"Inactive"}};function SubscriptionPage(){let{t:e,direction:t,language:a}=(0,l.Z)(),c=(0,n.useRouter)(),u=(0,n.useSearchParams)(),{subscription:m,refresh:h}=(0,i.m)(),[j,N]=(0,s.useState)([]),[k,C]=(0,s.useState)(!0),[S,_]=(0,s.useState)(!1),[E,P]=(0,s.useState)("card"),[Z,A]=(0,s.useState)("monthly"),[R,M]=(0,s.useState)(!1),[L,O]=(0,s.useState)(null);async function loadHistory(){C(!0);try{let e=await o.h.get("/api/dashboard/subscription/history");N(e.transactions||[])}catch(e){console.error("Error fetching history:",e)}finally{C(!1)}}async function handlePayment(){if(_(!0),"instapay"===E||"vodafone"===E){try{let e=await o.h.post("/api/dashboard/subscription/manual-pay",{payment_method:E,subscription_period:Z});if(e.error){alert(e.error),_(!1);return}O(e)}catch(e){alert(e.message||"Payment failed")}finally{_(!1)}return}try{let e=await o.h.post("/api/dashboard/subscription/pay",{paymentMethod:"card"});if(e.error){alert(e.error),_(!1);return}e.payment_url?window.location.href=e.payment_url:e.client_secret&&e.public_key?window.location.href="https://accept.paymob.com/unifiedcheckout/?publicKey=".concat(e.public_key,"&clientSecret=").concat(e.client_secret):(_(!1),alert("Something went wrong. Please try again."))}catch(e){alert(e.message||"Payment initiation failed"),_(!1)}}if((0,s.useEffect)(()=>{loadHistory(),h(),"complete"===u.get("status")&&(M(!0),setTimeout(()=>M(!1),5e3))},[u,h]),!m)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#008069]"})});let H=w[(null==m?void 0:m.status)||"inactive"],z=H.icon;return(0,r.jsxs)("div",{className:"p-4 max-w-2xl mx-auto space-y-6",dir:t,children:[(0,r.jsxs)("button",{onClick:()=>c.push("/dashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-[#008069] transition",children:[(0,r.jsx)(x.Z,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"font-medium",children:"ar"===a?"الرئيسية":"Home"})]}),R&&(0,r.jsx)("div",{className:"fixed top-4 right-4 left-4 md:left-auto md:w-96 bg-green-500 text-white p-4 rounded-lg shadow-lg z-50 animate-slide-down",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(d,{className:"w-6 h-6"}),(0,r.jsx)("span",{children:"ar"===a?"تم تفعيل اشتراكك بنجاح!":"Subscription activated successfully!"})]})}),(0,r.jsxs)("div",{className:"rounded-2xl ".concat(H.bgColor," p-6 shadow-sm"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"ar"===a?"الاشتراك":"Subscription"}),(0,r.jsx)("button",{onClick:()=>{h(),loadHistory()},className:"p-2 hover:bg-white/50 rounded-full transition",children:(0,r.jsx)(y.Z,{className:"w-5 h-5 text-gray-500"})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,r.jsx)("div",{className:"w-16 h-16 ".concat(H.color," rounded-full flex items-center justify-center"),children:(0,r.jsx)(z,{className:"w-8 h-8 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-2xl font-bold ".concat(H.textColor),children:"ar"===a?H.labelAr:H.labelEn}),(null==m?void 0:m.daysRemaining)!==null&&(null==m?void 0:m.daysRemaining)!==void 0&&m.daysRemaining>0&&(0,r.jsx)("p",{className:"text-gray-600",children:"ar"===a?"متبقي ".concat(m.daysRemaining," يوم"):"".concat(m.daysRemaining," days remaining")})]})]}),(null==m?void 0:m.isReadOnly)&&(0,r.jsx)("div",{className:"bg-yellow-100 border border-yellow-300 rounded-lg p-4 mb-4",children:(0,r.jsx)("p",{className:"text-yellow-800 font-medium",children:"ar"===a?"⚠️ لوحة التحكم في وضع القراءة فقط. جدد اشتراكك للاستمرار.":"⚠️ Dashboard is in read-only mode. Renew to continue."})}),(null==m?void 0:m.expiresAt)&&"active"===m.status&&(0,r.jsxs)("p",{className:"text-gray-500 text-sm",children:["ar"===a?"ينتهي في: ":"Expires: ",new Date(m.expiresAt).toLocaleDateString("ar"===a?"ar-EG":"en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),((null==m?void 0:m.status)!=="active"||(null==m?void 0:m.daysRemaining)!==null&&(null==m?void 0:m.daysRemaining)!==void 0&&m.daysRemaining<=7)&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:(null==m?void 0:m.status)==="active"?"ar"===a?"تجديد مبكر":"Early Renewal":"ar"===a?"اشترك الآن":"Subscribe Now"}),!(null==m?void 0:m.isFirstSubscription)&&(0,r.jsx)("div",{className:"flex justify-center mb-6",children:(0,r.jsxs)("div",{className:"bg-gray-100 p-1 rounded-xl flex",dir:"ltr",children:[(0,r.jsx)("button",{onClick:()=>A("monthly"),className:"px-6 py-2 rounded-lg text-sm font-medium transition-all ".concat("monthly"===Z?"bg-white text-[#008069] shadow-sm":"text-gray-500 hover:text-gray-700"),children:"Monthly"}),(0,r.jsxs)("button",{onClick:()=>A("yearly"),className:"px-6 py-2 rounded-lg text-sm font-medium transition-all ".concat("yearly"===Z?"bg-white text-[#008069] shadow-sm":"text-gray-500 hover:text-gray-700"),children:["Yearly",(0,r.jsx)("span",{className:"ml-1 text-[10px] bg-green-100 text-green-700 px-1.5 py-0.5 rounded-full",children:"-16%"})]})]})}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-[#008069] to-[#00a884] text-white rounded-xl p-4 mb-6",children:[(0,r.jsxs)("p",{className:"text-3xl font-bold",children:[(null==m?void 0:m.isFirstSubscription)?100:"yearly"===Z?3e3:300," EGP"]}),(0,r.jsx)("p",{className:"opacity-80",children:(null==m?void 0:m.isFirstSubscription)?"ar"===a?"للشهر الأول":"for the first month":"yearly"===Z?"ar"===a?"سنوياً":"per year":"ar"===a?"شهرياً":"per month"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[(0,r.jsxs)("button",{disabled:!0,className:"p-4 rounded-xl border-2 border-gray-200 bg-gray-100 opacity-60 cursor-not-allowed flex flex-col items-center gap-1",children:[(0,r.jsx)(p,{className:"w-6 h-6 text-gray-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-400",children:"ar"===a?"بطاقة":"Card"}),(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"ar"===a?"قريباً":"Soon"})]}),(0,r.jsxs)("button",{onClick:()=>{P("instapay"),O(null)},className:"p-4 rounded-xl border-2 transition flex flex-col items-center gap-2 ".concat("instapay"===E?"border-[#008069] bg-[#008069]/5":"border-gray-200 hover:border-gray-300"),children:[(0,r.jsx)(g.Z,{className:"w-6 h-6 ".concat("instapay"===E?"text-[#008069]":"text-gray-400")}),(0,r.jsx)("span",{className:"text-sm font-medium ".concat("instapay"===E?"text-[#008069]":"text-gray-600"),children:"InstaPay"})]}),(0,r.jsxs)("button",{onClick:()=>{P("vodafone"),O(null)},className:"p-4 rounded-xl border-2 transition flex flex-col items-center gap-2 ".concat("vodafone"===E?"border-[#008069] bg-[#008069]/5":"border-gray-200 hover:border-gray-300"),children:[(0,r.jsx)(f,{className:"w-6 h-6 ".concat("vodafone"===E?"text-[#008069]":"text-gray-400")}),(0,r.jsx)("span",{className:"text-sm font-medium ".concat("vodafone"===E?"text-[#008069]":"text-gray-600"),children:"Vodafone"})]})]}),L&&("instapay"===E||"vodafone"===E)&&(0,r.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-4 space-y-4",children:[(0,r.jsx)("p",{className:"text-amber-800 font-medium text-center",children:"ar"===a?"✅ تم منحك صلاحية 24 ساعة مؤقتة":"✅ You have 24h temporary access"}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("a",{href:L.payment_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 bg-blue-600 text-white py-3 px-4 rounded-xl font-medium hover:bg-blue-700",children:[(0,r.jsx)(b,{className:"w-5 h-5"}),"ar"===a?"افتح رابط الدفع":"Open Payment Link"]}),(0,r.jsxs)("a",{href:L.whatsapp_link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 bg-[#25D366] text-white py-3 px-4 rounded-xl font-medium hover:bg-[#1ebe57]",children:[(0,r.jsx)(v.Z,{className:"w-5 h-5"}),"ar"===a?"أرسل السكرين شوت":"Send Screenshot"]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"ar"===a?"بعد الدفع، أرسل سكرين شوت التحويل على الواتساب":"After payment, send the screenshot via WhatsApp"})]}),(!L||"card"===E)&&(0,r.jsx)("button",{onClick:handlePayment,disabled:S,className:"w-full bg-[#008069] hover:bg-[#006a58] text-white font-bold py-4 px-6 rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed",children:S?(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,r.jsx)("span",{children:"ar"===a?"جاري التحميل...":"Loading..."})]}):"card"===E?"ar"===a?"ادفع الآن":"Pay Now":"ar"===a?"تأكيد الدفع":"Confirm Payment"})]}),j.length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"ar"===a?"سجل المدفوعات":"Payment History"}),(0,r.jsx)("div",{className:"space-y-3",children:j.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium text-gray-800",children:[e.amount," EGP"]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString("ar"===a?"ar-EG":"en-US")})]}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("success"===e.status?"bg-green-100 text-green-700":"pending"===e.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:"success"===e.status?"ar"===a?"ناجح":"Success":"pending"===e.status?"ar"===a?"قيد الانتظار":"Pending":"ar"===a?"فشل":"Failed"})]},e.id))})]})]})}},4301:function(e,t,a){"use strict";a.d(t,{m:function(){return useSubscription},q:function(){return SubscriptionProvider}});var r=a(7573),s=a(7653),n=a(8681);let l=(0,s.createContext)({subscription:null,loading:!0,refresh:async()=>{}});function SubscriptionProvider(e){let{children:t}=e,[a,i]=(0,s.useState)(null),[o,c]=(0,s.useState)(!0),d=(0,s.useCallback)(async()=>{try{if(!n.h.isAuthenticated()){c(!1);return}let e=await n.h.get("/api/dashboard/subscription/status");i(e)}catch(e){console.error("Error fetching subscription status:",e)}finally{c(!1)}},[]);return(0,s.useEffect)(()=>{d()},[d]),(0,r.jsx)(l.Provider,{value:{subscription:a,loading:o,refresh:d},children:t})}function useSubscription(){let e=(0,s.useContext)(l);if(!e)throw Error("useSubscription must be used within a SubscriptionProvider");return e}},6923:function(e,t,a){"use strict";a.d(t,{Z:function(){return r.useLanguage}});var r=a(7855)},8294:function(e,t,a){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=a(7653),s=Symbol.for("react.element"),n=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,a){var r,n={},c=null,d=null;for(r in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,r)&&!o.hasOwnProperty(r)&&(n[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===n[r]&&(n[r]=t[r]);return{$$typeof:s,type:e,key:c,ref:d,props:n,_owner:i.current}}t.Fragment=n,t.jsx=q,t.jsxs=q},7573:function(e,t,a){"use strict";e.exports=a(8294)},2859:function(e,t,a){e.exports=a(7699)}},function(e){e.O(0,[612,293,53,744],function(){return e(e.s=3836)}),_N_E=e.O()}]);